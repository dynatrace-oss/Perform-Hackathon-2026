{
	"name": "Vegas Casino Environment",

	// Use a base image that has vscode user pre-configured
	"image": "mcr.microsoft.com/devcontainers/base:ubuntu-22.04",

	"hostRequirements": {
		"cpus": 4
	},

	"features": {
		"ghcr.io/devcontainers/features/docker-in-docker:2": {
			"version": "latest",
			"dockerDashComposeVersion": "v2"
		},
		"ghcr.io/devcontainers/features/kubectl-helm-minikube:1": {
			"version": "latest",
			"helm": "latest",
			"minikube": "none"
		}
	},

	// Set the remote user
	"remoteUser": "vscode",
	"forwardPorts": [8080],
	"portsAttributes": {

		"8080": { "label": "Gateway HTTP" }
	},

	// Install kind and run your setup scripts
	"postCreateCommand": "bash -c 'chmod +x .devcontainer/post_create.sh &&  chmod +x /workspaces/${RepositoryName}/codespace/deployment.sh && .devcontainer/post_create.sh && /workspaces/${RepositoryName}/deployment.sh --clustername ${localEnv:NAME} --dtid ${localEnv:DT_ENVIRONMENT_ID} --dtingesttoken ${localEnv:DT_API_TOKEN} --dtoperatortoken ${localEnv:DT_OPERATOR_TOKEN} --environment ${localEnv:DT_ENVIRONMENT_TYPE} --oauthclientid ${OAUTH_CLIENT_ID} --oauthclientsecret ${OAUTH_CLIENT_SECRET} --oauthclienturn ${OAUTH_CLIENT_URN}'",

	// Add recommended secrets
	"secrets": {
		"DT_ENVIRONMENT_ID": {
			"description": "eg. abc12345 from https://abc12345.apps.dynatrace.com"
		},
		"DT_ENVIRONMENT_TYPE": {
			"description": "live, sprint or dev. Leave blank for live. Defaults to live"
		},
		"DT_API_TOKEN": {
			"description": "Dynatrace API token with these permissions: `logs.ingest`, `metrics.ingest`, `openTelemetryTrace.ingest`, `events.ingest`"
		},
		"DT_OPERATOR_TOKEN": {
			"description": "Dynatrace API token with these permissions: `Installer download`, `DataExport`, `settings.read`, `settings.write`,`entities.read`, `activeGateTokenManagement.create`"
		},
		
		"NAME": {
			"description": "Name of the environment"
		},
		"OAUTH_CLIENT_ID": {
			"description": "Oauth client id"
		},
		"OAUTH_CLIENT_SECRET": {
			"description": "Oauth client secret"
		},
		"OAUTH_CLIENT_URN": {
			"description": "Oauth client urn"
		}
	
	},

	// Add Kubernetes VSCode extensions
	"customizations": {
		"vscode": {
			"extensions": [
				"ms-kubernetes-tools.vscode-kubernetes-tools",
				"redhat.vscode-yaml"
			]
		}
	}
}