{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Vegas Casino - Observability Hackathon","text":"<p>Welcome to the Vegas Casino project documentation! This is a microservices-based casino application designed specifically for observability hackathons where attendees will improve instrumentation and application pipelines.</p>"},{"location":"#what-is-vegas-casino","title":"\ud83c\udfb0 What is Vegas Casino?","text":"<p>Vegas Casino is a comprehensive microservices application that simulates a real-world casino environment. It's built with multiple services using different programming languages and technologies, making it an ideal platform for:</p> <ul> <li>Observability Practice: Learn and implement distributed tracing, metrics, and logging</li> <li>Feature Flag Management: Experiment with OpenFeature and flagd for feature toggling</li> <li>Load Testing: Test application performance under various conditions</li> <li>DevOps Practices: Practice CI/CD, containerization, and Kubernetes deployment</li> </ul>"},{"location":"#quick-start","title":"\ud83d\ude80 Quick Start","text":"<pre><code># Build all Docker images\nmake docker-build-all\n\n# Deploy using Helm\nhelm install vegas-casino ./helm/vegas-casino\n\n# Run Playwright automation\nkubectl apply -f helm/vegas-casino/templates/playwright-deployment.yaml\n\n# Run k6 load tests\nkubectl apply -f helm/vegas-casino/templates/k6-deployment.yaml\n</code></pre>"},{"location":"#documentation-sections","title":"\ud83d\udcda Documentation Sections","text":"<ul> <li>Overview - Learn about the project and hackathon context</li> <li>Architecture - Understand the system design and components</li> <li>Development - Build and generate Docker images</li> <li>Testing - Playwright and k6 testing guides</li> <li>Deployment - Deploy to Kubernetes with Helm or manifests</li> </ul>"},{"location":"#key-features","title":"\ud83c\udfaf Key Features","text":"<ul> <li>Multi-Language Services: Node.js, Python, Go, and Java</li> <li>Feature Flags: OpenFeature with flagd sidecar injection</li> <li>Distributed Tracing: OpenTelemetry with gRPC export</li> <li>Load Testing: k6 and Playwright automation</li> <li>Observability: Comprehensive logging, metrics, and traces</li> </ul>"},{"location":"#technology-stack","title":"\ud83d\udee0\ufe0f Technology Stack","text":"<ul> <li>Frontend: Node.js/Express</li> <li>Game Services: Node.js, Python, Go</li> <li>Scoring Service: Java/Spring Boot</li> <li>Feature Flags: OpenFeature Operator + flagd</li> <li>Observability: OpenTelemetry</li> <li>Orchestration: Kubernetes + Helm</li> </ul> <p>Ready to get started? Check out the Project Overview or jump to Building the Project!</p>"},{"location":"contributing/","title":"Contributing","text":""},{"location":"contributing/#how-to-contribute","title":"How to Contribute","text":"<p>The Vegas Casino project welcomes contributions! Here's how you can help:</p>"},{"location":"contributing/#areas-for-improvement","title":"Areas for Improvement","text":""},{"location":"contributing/#instrumentation","title":"Instrumentation","text":"<ul> <li>Add missing OpenTelemetry spans</li> <li>Improve trace context propagation</li> <li>Add database operation spans</li> <li>Enhance span attributes</li> </ul>"},{"location":"contributing/#feature-flags","title":"Feature Flags","text":"<ul> <li>Add new feature flags</li> <li>Implement flag evaluation in services</li> <li>Create flag targeting rules</li> <li>Test flag variations</li> </ul>"},{"location":"contributing/#testing","title":"Testing","text":"<ul> <li>Create new Playwright scenarios</li> <li>Add k6 test cases</li> <li>Improve test coverage</li> <li>Add performance benchmarks</li> </ul>"},{"location":"contributing/#documentation","title":"Documentation","text":"<ul> <li>Improve documentation clarity</li> <li>Add examples and tutorials</li> <li>Fix typos and errors</li> <li>Add diagrams and visuals</li> </ul>"},{"location":"contributing/#development-workflow","title":"Development Workflow","text":"<ol> <li>Fork the Repository</li> <li>Create a Feature Branch <pre><code>git checkout -b feature/my-improvement\n</code></pre></li> <li>Make Changes</li> <li>Test Your Changes <pre><code>make docker-build-all\nmake test-all\n</code></pre></li> <li>Commit Changes <pre><code>git commit -m \"Add: description of changes\"\n</code></pre></li> <li>Push and Create Pull Request</li> </ol>"},{"location":"contributing/#code-style","title":"Code Style","text":"<ul> <li>Follow language-specific style guides</li> <li>Add comments for complex logic</li> <li>Include error handling</li> <li>Write meaningful commit messages</li> </ul>"},{"location":"contributing/#testing-requirements","title":"Testing Requirements","text":"<ul> <li>All new features should include tests</li> <li>Playwright tests for UI changes</li> <li>k6 tests for API changes</li> <li>Unit tests for service logic</li> </ul>"},{"location":"contributing/#documentation_1","title":"Documentation","text":"<ul> <li>Update relevant documentation</li> <li>Add examples for new features</li> <li>Keep architecture diagrams current</li> <li>Update deployment guides if needed</li> </ul>"},{"location":"contributing/#questions","title":"Questions?","text":"<p>Feel free to open an issue or start a discussion!</p> <p>Thank you for contributing to Vegas Casino! \ud83c\udfb0</p>"},{"location":"getting-started/","title":"Getting Started'","text":""},{"location":"getting-started/#gather-details-create-api-token","title":"Gather Details: Create API Token","text":"<p>This Workshop requires 2 API tokens: * One to deploy the Dynatrace Operator * One to ingest metrics, logs, traces and events</p> <p>You have been invited to a Dynatrace tenant.</p> <p>All the relevant applications are displayed on your welcome screen: </p>"},{"location":"getting-started/#gather-details-create-edgeconnect-oauth-client","title":"Gather Details: Create EdgeConnect OAuth Client","text":"<p>EdgeConnect requires an OAuth client to authenticate with your Dynatrace environment. The OAuth client is automatically created when you create an EdgeConnect configuration in Dynatrace.</p>"},{"location":"getting-started/#step-1-create-edgeconnect-configuration","title":"Step 1: Create EdgeConnect Configuration","text":"<ol> <li>Go to Settings &gt; General &gt; External Requests &gt; EdgeConnect in your Dynatrace environment.</li> <li>Select New EdgeConnect.</li> <li>Enter a unique Name for the EdgeConnect instance (e.g., <code>obs-istio-edgeconnect</code>).</li> <li>Name must be RFC 1123 Label Names compliant with maximum length of 50 characters</li> <li>Provide the Host patterns of the requests that should be handled by the EdgeConnect instance.</li> <li>You can use wildcards to replace the first parts of the host domain (e.g., <code>*.myapp.org</code> matches <code>staging.myapp.org</code> and <code>prod.myapp.org</code>)</li> <li>For Kubernetes automation, you might use patterns like <code>kubernetes.default.svc.cluster.local</code> or <code>*.svc.cluster.local</code></li> <li>Select Create.</li> </ol>"},{"location":"getting-started/#step-2-download-edgeconnect-configuration-file","title":"Step 2: Download EdgeConnect Configuration File","text":"<ol> <li>After creating the EdgeConnect configuration, download the <code>edgeConnect.yaml</code> configuration file.</li> <li>This file contains all the OAuth credentials you need</li> <li>Important: The OAuth client secret is only displayed once and cannot be retrieved later</li> <li>Make sure to save this file securely</li> </ol>"},{"location":"getting-started/#step-3-extract-oauth-credentials","title":"Step 3: Extract OAuth Credentials","text":"<p>Open the downloaded <code>edgeConnect.yaml</code> file and extract the following values:</p> <pre><code>name: obs-istio-edgeconnect\napi_endpoint_host: abc12345.apps.dynatrace.com\noauth:\n  endpoint: https://sso.dynatrace.com/sso/oauth2/token\n  client_id: dt0s10.your-oauth-client-id\n  client_secret: ********  # This is only shown once!\n  resource: urn:dtenvironment:abc12345\n</code></pre> <p>You'll need these values for your environment variables:</p> <ul> <li>OAUTH_CLIENT_ID: The <code>oauth.client_id</code> value (e.g., <code>dt0s10.your-oauth-client-id</code>)</li> <li>OAUTH_CLIENT_SECRET: The <code>oauth.client_secret</code> value</li> <li>OAUTH_CLIENT_URN: The <code>oauth.resource</code> value (e.g., <code>urn:dtenvironment:abc12345</code>)</li> </ul>"},{"location":"getting-started/#step-4-verify-edgeconnect-connection","title":"Step 4: Verify EdgeConnect Connection","text":"<p>After deploying EdgeConnect (see deployment instructions), validate the connection:</p> <ol> <li>Go to Settings &gt; General &gt; External Requests &gt; EdgeConnect.</li> <li>Check the Availability column. It should display online.</li> <li>If it's still offline, check the container logs for error messages.</li> </ol> <p>For more details, see the Dynatrace EdgeConnect documentation.</p>"},{"location":"getting-started/#alternative-using-dynatrace-operator-with-provisioner","title":"Alternative: Using Dynatrace Operator with Provisioner","text":"<p>If you're using the Dynatrace Operator with <code>oauth.provisioner: true</code> in your EdgeConnect custom resource (as shown in <code>codespace/dynatrace/edge-connect.yaml</code>), the Operator will automatically create and manage the OAuth client for you. In this case, you don't need to manually create the EdgeConnect configuration in the Dynatrace UI.</p>"},{"location":"getting-started/#start-demo","title":"Start Demo","text":"Run in CloudRun Locally <p>Click this button to launch the demo in a new tab.</p> <p></p> <ul> <li> <p>Clone the repository to your local machine</p> <pre><code>git clone -b V3-Workshop --single-branch https://github.com/isItObservable/servicemeshsecuritybenchmark.git\n</code></pre> <ul> <li>Open the folder in Visual Studio code</li> <li>Ensure the Microsoft Dev Containers extension and Dev Containers CLI are installed in VSCode</li> <li>Open a new terminal in VSCode and set your environment variables as appropriate:</li> </ul> <pre><code>set DT_ENVIRONMENT_ID=abc12345\nset DT_ENVIRONMENT_TYPE=live\nset DT_API_TOKEN=dt0c01.******.***********\nset DT_OPERATOR_TOKEN=dt0c01.******.***********\nset OAUTH_CLIENT_ID=****\nset OAUTH_CLIENT_SECRET=******\nset OAUTH_CLIENT_URN=*****\nset NAME= &lt;Name of your environment&gt;\n</code></pre> <ul> <li>Start Docker / Podman</li> <li>Create the environment</li> </ul> <pre><code>devcontainer up\n</code></pre> <p>It will take a few moments but you should see:</p> <pre><code>{\"outcome\":\"success\",\"containerId\":\"...\",\"remoteUser\":\"root\",\"remoteWorkspaceFolder\":\"/workspaces/servicemeshsecuritybenchmark\"}\n</code></pre> <ul> <li>Connect to the demo environment. This will launch a new Visual Studio Code window <pre><code>devcontainer open\n</code></pre></li> </ul> <p>In the new Visual Studio code window, open a new terminal and continue with the tutorial.</p> </li> </ul> <ul> <li>Click Here to Run the Demo :octicons-arrow-right-24:</li> </ul>"},{"location":"architecture/","title":"Architecture Overview","text":""},{"location":"architecture/#system-architecture","title":"System Architecture","text":"<p>Vegas Casino follows a microservices architecture with multiple independent services. The frontend service uses gRPC exclusively to communicate with game services (no HTTP fallback). HTTP is only used for browser-to-frontend communication and service-to-scoring communication.</p> <pre><code>graph TB\n    Browser[Browser&lt;br/&gt;HTTP Client]\n    Frontend[Frontend Service&lt;br/&gt;Node.js/Express&lt;br/&gt;Port: 3000&lt;br/&gt;HTTP + gRPC Client]\n\n    Slots[Slots Service&lt;br/&gt;Node.js&lt;br/&gt;gRPC: 50051&lt;br/&gt;HTTP: 8081 legacy]\n    Roulette[Roulette Service&lt;br/&gt;Python&lt;br/&gt;gRPC: 50052&lt;br/&gt;HTTP: 8082 legacy]\n    Dice[Dice Service&lt;br/&gt;Go&lt;br/&gt;gRPC: 50053&lt;br/&gt;HTTP: 8083 legacy]\n    Blackjack[Blackjack Service&lt;br/&gt;Node.js&lt;br/&gt;gRPC: 50054&lt;br/&gt;HTTP: 8084 legacy]\n\n    Dashboard[Dashboard Service&lt;br/&gt;Node.js&lt;br/&gt;gRPC: 50055&lt;br/&gt;HTTP: 3001]\n    Scoring[Scoring Service&lt;br/&gt;Java/Spring Boot&lt;br/&gt;HTTP: 8085]\n\n    Redis[(Redis&lt;br/&gt;Port: 6379)]\n    PostgreSQL[(PostgreSQL&lt;br/&gt;Port: 5432)]\n\n    Browser --&gt;|HTTP REST API| Frontend\n    Frontend --&gt;|gRPC ONLY| Slots\n    Frontend --&gt;|gRPC ONLY| Roulette\n    Frontend --&gt;|gRPC ONLY| Dice\n    Frontend --&gt;|gRPC ONLY| Blackjack\n    Frontend --&gt;|gRPC| Dashboard\n    Frontend --&gt;|Redis Direct| Redis\n\n    Slots --&gt;|Redis Direct| Redis\n    Roulette --&gt;|Redis Direct| Redis\n    Dice --&gt;|Redis Direct| Redis\n    Blackjack --&gt;|Redis Direct| Redis\n\n    Slots --&gt;|HTTP| Scoring\n    Roulette --&gt;|HTTP| Scoring\n    Dice --&gt;|HTTP| Scoring\n    Blackjack --&gt;|HTTP| Scoring\n\n    Dashboard --&gt;|HTTP| Scoring\n    Scoring --&gt;|PostgreSQL| PostgreSQL\n\n    style Frontend fill:#9333ea,stroke:#7c3aed,color:#fff\n    style Dashboard fill:#9333ea,stroke:#7c3aed,color:#fff\n    style Slots fill:#06b6d4,stroke:#0891b2,color:#fff\n    style Roulette fill:#06b6d4,stroke:#0891b2,color:#fff\n    style Dice fill:#06b6d4,stroke:#0891b2,color:#fff\n    style Blackjack fill:#06b6d4,stroke:#0891b2,color:#fff\n    style Scoring fill:#dc2626,stroke:#b91c1c,color:#fff\n    style Redis fill:#f59e0b,stroke:#d97706,color:#fff\n    style PostgreSQL fill:#10b981,stroke:#059669,color:#fff</code></pre>"},{"location":"architecture/#service-communication","title":"Service Communication","text":""},{"location":"architecture/#http-communication","title":"HTTP Communication","text":"<ul> <li>Browser \u2192 Frontend Service: All browser requests use HTTP (Port 3000)</li> <li>Static files (HTML, CSS, JS)</li> <li>REST API endpoints:<ul> <li><code>/api/user/*</code> - User management (login, balance, topup, init)</li> <li><code>/api/games/:gameId/spin</code> - Game play (internally converts to gRPC)</li> <li><code>/api/games/:gameId/roll</code> - Game play (internally converts to gRPC)</li> <li><code>/api/games/:gameId/deal</code> - Game play (internally converts to gRPC)</li> <li><code>/api/dashboard/*</code> - Dashboard data (internally converts to gRPC)</li> </ul> </li> <li>Dashboard \u2192 Scoring Service: HTTP REST API (Port 8085)</li> <li>Game Services \u2192 Scoring Service: HTTP REST API for recording game results</li> </ul>"},{"location":"architecture/#grpc-communication-service-to-service","title":"gRPC Communication (Service-to-Service)","text":"<ul> <li>Frontend \u2192 Game Services: ONLY gRPC (no HTTP fallback)</li> <li>All game interactions use gRPC exclusively:<ul> <li>Slots: <code>Spin()</code> method via gRPC (Port 50051)</li> <li>Roulette: <code>Spin()</code> method via gRPC (Port 50052)</li> <li>Dice: <code>Roll()</code> method via gRPC (Port 50053)</li> <li>Blackjack: <code>Deal()</code>, <code>Hit()</code>, <code>Stand()</code>, <code>Double()</code> methods via gRPC (Port 50054)</li> </ul> </li> <li>No HTTP fallback: If gRPC fails, the request fails (no HTTP retry)</li> <li>Frontend \u2192 Dashboard Service: gRPC (Port 50055) for dashboard statistics</li> <li>Methods: <code>getAllDashboardStats()</code>, <code>getDashboardStats(game)</code></li> <li>Protocol: Protocol Buffers for type safety and better performance</li> <li>Important: Frontend HTTP endpoints (<code>/api/games/*</code>) are browser-facing REST APIs that internally convert to gRPC calls. The browser never directly calls game services.</li> </ul>"},{"location":"architecture/#redis-communication","title":"Redis Communication","text":"<ul> <li>Frontend \u2194 Redis (direct connection for balance and user profile management)</li> <li>Game Services \u2194 Redis (direct connection for game state storage)</li> </ul>"},{"location":"architecture/#data-flow","title":"Data Flow","text":""},{"location":"architecture/#user-login-and-profile-creation","title":"User Login and Profile Creation","text":"<pre><code>sequenceDiagram\n    participant Browser\n    participant Frontend\n    participant Redis\n\n    Browser-&gt;&gt;Frontend: POST /api/user/login&lt;br/&gt;(name, email, profileType, balance)\n    Frontend-&gt;&gt;Redis: SET balance:{username}\n    Frontend-&gt;&gt;Redis: SET user:{username}&lt;br/&gt;(email, profileType, createdAt)\n    Redis--&gt;&gt;Frontend: Success\n    Frontend--&gt;&gt;Browser: User profile created\n    Browser-&gt;&gt;Browser: Store in localStorage&lt;br/&gt;(username, email, profileType)</code></pre>"},{"location":"architecture/#game-play-flow","title":"Game Play Flow","text":"<pre><code>sequenceDiagram\n    participant Browser\n    participant Frontend\n    participant Redis\n    participant Game as Game Service\n    participant Scoring\n    participant PostgreSQL\n\n    Browser-&gt;&gt;Frontend: POST /api/games/{game}/play&lt;br/&gt;(HTTP Request)\n    Frontend-&gt;&gt;Redis: GET balance:{username}\n    Redis--&gt;&gt;Frontend: Current Balance\n    Frontend-&gt;&gt;Game: gRPC Call&lt;br/&gt;(Spin/Roll/Deal with bet_amount)\n    Game-&gt;&gt;Redis: Store Game State\n    Game-&gt;&gt;Game: Process Game Logic\n    Game-&gt;&gt;Redis: Update Game State\n    Game-&gt;&gt;Scoring: POST /api/scoring/result&lt;br/&gt;(HTTP - Record win/loss)\n    Scoring-&gt;&gt;PostgreSQL: INSERT game_result\n    Scoring--&gt;&gt;Game: Success\n    Game--&gt;&gt;Frontend: gRPC Response&lt;br/&gt;(result, payout, new_balance)\n    Frontend-&gt;&gt;Redis: SET balance:{username}&lt;br/&gt;(Update with new balance)\n    Frontend--&gt;&gt;Browser: JSON Response&lt;br/&gt;(game result, updated balance)\n    Browser-&gt;&gt;Browser: Update UI</code></pre>"},{"location":"architecture/#dashboard-view-flow","title":"Dashboard View Flow","text":"<pre><code>sequenceDiagram\n    participant Browser\n    participant Frontend\n    participant Dashboard as Dashboard Service\n    participant Scoring\n    participant PostgreSQL\n\n    Browser-&gt;&gt;Frontend: GET /api/dashboard&lt;br/&gt;(HTTP Request)\n    Frontend-&gt;&gt;Dashboard: gRPC getAllDashboardStats()\n    Dashboard-&gt;&gt;Scoring: GET /api/scoring/stats&lt;br/&gt;(HTTP Request)\n    Scoring-&gt;&gt;PostgreSQL: SELECT game_results, player_scores\n    PostgreSQL--&gt;&gt;Scoring: Statistics Data\n    Scoring--&gt;&gt;Dashboard: JSON Response\n    Dashboard--&gt;&gt;Frontend: gRPC Response&lt;br/&gt;(aggregated stats)\n    Frontend--&gt;&gt;Browser: JSON Response&lt;br/&gt;(dashboard data)\n    Browser-&gt;&gt;Browser: Render Charts &amp; Tables</code></pre>"},{"location":"architecture/#balance-management-flow","title":"Balance Management Flow","text":"<pre><code>sequenceDiagram\n    participant Browser\n    participant Frontend\n    participant Redis\n\n    Browser-&gt;&gt;Frontend: POST /api/user/topup&lt;br/&gt;(amount)\n    Frontend-&gt;&gt;Redis: GET balance:{username}\n    Redis--&gt;&gt;Frontend: Current Balance\n    Frontend-&gt;&gt;Redis: INCRBY balance:{username}&lt;br/&gt;(add amount)\n    Redis--&gt;&gt;Frontend: New Balance\n    Frontend--&gt;&gt;Browser: Updated Balance\n\n    Browser-&gt;&gt;Frontend: GET /api/user/balance&lt;br/&gt;(username)\n    Frontend-&gt;&gt;Redis: GET balance:{username}\n    Redis--&gt;&gt;Frontend: Balance\n    Frontend--&gt;&gt;Browser: Balance</code></pre>"},{"location":"architecture/#observability-stack","title":"Observability Stack","text":"<pre><code>graph LR\n    subgraph \"Application Services\"\n        Frontend[Frontend]\n        Game1[Game Services]\n        Scoring[Scoring]\n        Dashboard[Dashboard]\n    end\n\n    subgraph \"OpenTelemetry\"\n        OTEL[OTEL SDK&lt;br/&gt;Auto-instrumentation]\n        OTLP[OTLP Exporter&lt;br/&gt;gRPC]\n    end\n\n    subgraph \"Infrastructure\"\n        Collector[OTEL Collector&lt;br/&gt;Port: 4317]\n        Platform[Observability Platform&lt;br/&gt;Dynatrace/Other]\n    end\n\n    Frontend --&gt; OTEL\n    Game1 --&gt; OTEL\n    Scoring --&gt; OTEL\n    Dashboard --&gt; OTEL\n\n    OTEL --&gt; OTLP\n    OTLP --&gt;|gRPC| Collector\n    Collector --&gt; Platform\n\n    style OTEL fill:#06b6d4,stroke:#0891b2,color:#fff\n    style Collector fill:#9333ea,stroke:#7c3aed,color:#fff\n    style Platform fill:#10b981,stroke:#059669,color:#fff</code></pre> <ul> <li>OpenTelemetry: Distributed tracing and metrics</li> <li>OpenTelemetry Collector: Receives and exports telemetry data</li> <li>gRPC Exporter: Sends traces to collector on port 4317</li> <li>Trace Context Propagation: W3C Trace Context across all services</li> </ul>"},{"location":"architecture/#feature-flag-management","title":"Feature Flag Management","text":"<pre><code>graph TB\n    subgraph \"Kubernetes Cluster\"\n        subgraph \"OpenFeature Operator\"\n            Operator[Operator Controller]\n        end\n\n        subgraph \"Application Pod\"\n            Service[Application Service]\n            Flagd[flagd Sidecar&lt;br/&gt;Port: 8014]\n        end\n\n        CRD[FeatureFlag CRD&lt;br/&gt;Flag Definitions]\n        Source[FeatureFlagSource CRD&lt;br/&gt;Configuration]\n    end\n\n    Operator --&gt;|Watches| Service\n    Operator --&gt;|Injects| Flagd\n    Source --&gt;|Configures| Flagd\n    CRD --&gt;|Provides Flags| Flagd\n    Service --&gt;|localhost:8014| Flagd\n    Flagd --&gt;|Reads| CRD\n\n    style Operator fill:#dc2626,stroke:#b91c1c,color:#fff\n    style Flagd fill:#f59e0b,stroke:#d97706,color:#fff\n    style CRD fill:#10b981,stroke:#059669,color:#fff</code></pre> <ul> <li>OpenFeature Operator: Manages flagd sidecar injection</li> <li>flagd: Feature flag evaluation service (sidecar)</li> <li>FeatureFlagSource: Kubernetes CRD for flag configuration</li> <li>FeatureFlag: Kubernetes CRD for flag definitions</li> </ul> <p>Next: Learn about Components or the Technology Stack.</p>"},{"location":"architecture/components/","title":"Components","text":""},{"location":"architecture/components/#core-services","title":"Core Services","text":""},{"location":"architecture/components/#frontend-service","title":"Frontend Service","text":"<ul> <li>Language: Node.js/Express</li> <li>Port: 3000 (HTTP)</li> <li>Purpose: Web UI gateway, user management, game orchestration, balance management</li> <li>Key Features:</li> <li>User Authentication: Login screen with profile creation (name, email, profile type, starting balance)</li> <li>Static File Serving: Serves HTML, CSS, JS files for game UIs</li> <li>Balance Management: Direct Redis connection for all balance operations<ul> <li>User balance storage and retrieval</li> <li>Balance updates on deposits and game results</li> <li>User profile information storage</li> </ul> </li> <li>gRPC Client: Primary communication protocol<ul> <li>Game services (Slots, Roulette, Dice, Blackjack)</li> <li>Dashboard service for statistics</li> </ul> </li> <li>HTTP REST API: Browser-facing endpoints<ul> <li><code>/api/user/*</code> - User management (login, balance, topup, init)</li> <li><code>/api/games/{game}/play</code> - Game play requests (converts to gRPC)</li> <li><code>/api/dashboard/*</code> - Dashboard data (converts to gRPC)</li> </ul> </li> <li>Browser-side OpenTelemetry: Automatic instrumentation for browser requests</li> <li>Trace Context Propagation: W3C TraceContext across all services</li> </ul>"},{"location":"architecture/components/#game-services","title":"Game Services","text":""},{"location":"architecture/components/#slots-service","title":"Slots Service","text":"<ul> <li>Language: Node.js</li> <li>Ports: 8081 (HTTP - legacy), 50051 (gRPC - primary)</li> <li>Purpose: Slot machine game logic</li> <li>Communication:</li> <li>Receives gRPC requests from Frontend Service</li> <li>Calls Scoring Service via HTTP to record results</li> <li>Features:</li> <li>Progressive jackpot support</li> <li>Bonus rounds</li> <li>Cheat detection (feature flag)</li> <li>Redis state management for game sessions</li> <li>Records wins to Scoring Service</li> </ul>"},{"location":"architecture/components/#roulette-service","title":"Roulette Service","text":"<ul> <li>Language: Python/Flask</li> <li>Ports: 8082 (HTTP - legacy), 50052 (gRPC - primary)</li> <li>Purpose: European roulette game</li> <li>Communication:</li> <li>Receives gRPC requests from Frontend Service</li> <li>Calls Scoring Service via HTTP to record results</li> <li>Features:</li> <li>Multiple bet types (number, color, high/low, odd/even)</li> <li>Complex multiple bets support</li> <li>Live wheel simulation</li> <li>Cheat codes (feature flag)</li> <li>Redis state management for game sessions</li> <li>Records wins to Scoring Service</li> </ul>"},{"location":"architecture/components/#dice-service","title":"Dice Service","text":"<ul> <li>Language: Go</li> <li>Ports: 8083 (HTTP - legacy), 50053 (gRPC - primary)</li> <li>Purpose: Craps/dice game</li> <li>Communication:</li> <li>Receives gRPC requests from Frontend Service</li> <li>Calls Scoring Service via HTTP to record results</li> <li>Features:</li> <li>Pass-line and come bets</li> <li>Feature flag integration</li> <li>Redis state management for game sessions</li> <li>Records wins to Scoring Service</li> </ul>"},{"location":"architecture/components/#blackjack-service","title":"Blackjack Service","text":"<ul> <li>Language: Node.js</li> <li>Ports: 8084 (HTTP - legacy), 50054 (gRPC - primary)</li> <li>Purpose: Blackjack card game</li> <li>Communication:</li> <li>Receives gRPC requests from Frontend Service</li> <li>Calls Scoring Service via HTTP to record results</li> <li>Features:</li> <li>Double down, insurance, surrender</li> <li>Feature flag integration</li> <li>Redis state management for game sessions</li> <li>Records wins to Scoring Service</li> </ul>"},{"location":"architecture/components/#scoring-service","title":"Scoring Service","text":"<ul> <li>Language: Java/Spring Boot</li> <li>Port: 8085 (HTTP)</li> <li>Purpose: Game statistics, leaderboards, scoring</li> <li>Database: PostgreSQL</li> <li>Features:</li> <li>Player score tracking</li> <li>Game result storage</li> <li>Dashboard statistics</li> <li>Top players leaderboard</li> </ul>"},{"location":"architecture/components/#dashboard-service","title":"Dashboard Service","text":"<ul> <li>Language: Node.js/Express</li> <li>Ports: 3001 (HTTP), 50055 (gRPC)</li> <li>Purpose: Analytics and reporting dashboard</li> <li>Features:</li> <li>Game statistics visualization</li> <li>Top players display</li> <li>Win/loss analytics</li> <li>Real-time data from scoring service</li> <li>gRPC API for dashboard statistics</li> <li>Aggregates data from scoring service via HTTP</li> </ul>"},{"location":"architecture/components/#supporting-services","title":"Supporting Services","text":""},{"location":"architecture/components/#redis","title":"Redis","text":"<ul> <li>Purpose: Game state storage, session management, user balance storage</li> <li>Port: 6379</li> <li>Usage: </li> <li>All game services use Redis for state persistence</li> <li>Frontend directly connects to Redis for user balance storage and retrieval</li> <li>Frontend stores user balances with key pattern: <code>balance:{username}</code></li> <li>Frontend stores user profile information (email, profile type, balance, created timestamp)</li> <li>Stores game state during active sessions</li> <li>All balance operations (deposit, init, login) are persisted in Redis</li> <li>Configuration: Environment variables <code>REDIS_HOST</code>, <code>REDIS_PORT</code>, <code>REDIS_PASSWORD</code></li> <li>Connection: Direct Redis client connection (not through game services)</li> </ul>"},{"location":"architecture/components/#postgresql","title":"PostgreSQL","text":"<ul> <li>Purpose: Persistent storage for scores and game results</li> <li>Port: 5432</li> <li>Schema: </li> <li><code>player_scores</code> table - Stores player leaderboard data</li> <li><code>game_results</code> table - Stores individual game results</li> <li>Configuration: Environment variables <code>DB_HOST</code>, <code>DB_PORT</code>, <code>DB_NAME</code>, <code>DB_USER</code>, <code>DB_PASSWORD</code></li> </ul>"},{"location":"architecture/components/#opentelemetry-collector","title":"OpenTelemetry Collector","text":"<ul> <li>Purpose: Receives telemetry data and exports to observability platform</li> <li>Port: 4317 (gRPC), 4318 (HTTP)</li> <li>Protocol: gRPC (primary)</li> </ul>"},{"location":"architecture/components/#feature-flag-infrastructure","title":"Feature Flag Infrastructure","text":""},{"location":"architecture/components/#openfeature-operator","title":"OpenFeature Operator","text":"<ul> <li>Purpose: Kubernetes operator for automatic flagd sidecar injection</li> <li>CRDs: </li> <li><code>FeatureFlagSource</code>: Links flagd to flag definitions</li> <li><code>FeatureFlag</code>: Defines feature flag configurations</li> <li>Installation: Must be installed before application deployment</li> </ul>"},{"location":"architecture/components/#flagd","title":"flagd","text":"<ul> <li>Purpose: Feature flag evaluation service (runs as sidecar)</li> <li>Port: 8014 (gRPC), 8015 (Management)</li> <li>Integration: Injected automatically by OpenFeature Operator</li> <li>Configuration: Via FeatureFlagSource CRD</li> <li>Language Support: </li> <li>Node.js: <code>@openfeature/flagd-provider</code></li> <li>Go: <code>github.com/open-feature/go-sdk-contrib/providers/flagd</code></li> <li>Python: <code>openfeature-flagd-provider</code> (if available)</li> </ul>"},{"location":"architecture/components/#testing-components","title":"Testing Components","text":""},{"location":"architecture/components/#playwright-automation","title":"Playwright Automation","text":"<ul> <li>Purpose: End-to-end user journey simulation</li> <li>Language: Node.js</li> <li>Features:</li> <li>User registration and login</li> <li>Game play simulation</li> <li>Feature flag interaction</li> <li>Dashboard verification</li> </ul>"},{"location":"architecture/components/#k6-load-testing","title":"k6 Load Testing","text":"<ul> <li>Purpose: Performance and load testing</li> <li>Language: JavaScript (k6)</li> <li>Features:</li> <li>Configurable virtual users</li> <li>Ramp-up and duration control</li> <li>Custom metrics</li> <li>Real-time performance monitoring</li> </ul>"},{"location":"architecture/components/#communication-patterns","title":"Communication Patterns","text":""},{"location":"architecture/components/#grpc-primary-protocol-for-service-to-service","title":"gRPC (Primary Protocol for Service-to-Service)","text":"<ul> <li>Frontend \u2192 Game Services: ONLY gRPC (no HTTP fallback)</li> <li>Slots: Port 50051</li> <li>Roulette: Port 50052</li> <li>Dice: Port 50053</li> <li>Blackjack: Port 50054</li> <li>Frontend \u2192 Dashboard Service: gRPC (Port 50055)</li> <li>Protocol: Protocol Buffers for type safety</li> <li>Benefits: Better performance, type safety, streaming support</li> <li>Note: Frontend service exposes HTTP REST endpoints (<code>/api/games/*</code>) that the browser calls, but these endpoints internally convert to gRPC calls to game services</li> </ul>"},{"location":"architecture/components/#http-rest-apis","title":"HTTP (REST APIs)","text":"<ul> <li>Browser \u2192 Frontend Service: All browser requests use HTTP (Port 3000)</li> <li>Static file serving (HTML, CSS, JS)</li> <li>REST API endpoints:<ul> <li><code>/api/user/*</code> - User management (login, balance, topup, init)</li> <li><code>/api/games/:gameId/spin</code> - Game play (converts to gRPC internally)</li> <li><code>/api/games/:gameId/roll</code> - Game play (converts to gRPC internally)</li> <li><code>/api/games/:gameId/deal</code> - Game play (converts to gRPC internally)</li> <li><code>/api/dashboard/*</code> - Dashboard data (converts to gRPC internally)</li> </ul> </li> <li>Dashboard \u2192 Scoring Service: HTTP REST API (Port 8085)</li> <li>Game Services \u2192 Scoring Service: HTTP REST API for recording results</li> </ul>"},{"location":"architecture/components/#redis-direct-connection","title":"Redis (Direct Connection)","text":"<ul> <li>Frontend \u2192 Redis: Direct Redis client connection</li> <li>User balance storage and retrieval</li> <li>User profile information storage</li> <li>Operations: <code>GET</code>, <code>SET</code>, <code>INCRBY</code> for balance management</li> <li>Key patterns: <code>balance:{username}</code>, <code>user:{username}</code></li> <li>Game Services \u2192 Redis: Direct Redis connections for game state</li> <li>Protocol: Redis protocol (RESP)</li> <li>Port: 6379</li> </ul>"},{"location":"architecture/components/#database-postgresql","title":"Database (PostgreSQL)","text":"<ul> <li>Scoring Service \u2192 PostgreSQL: Direct database connection</li> <li>Game results storage</li> <li>Player scores and leaderboards</li> <li>Dashboard statistics queries</li> </ul> <p>Next: Learn about the Technology Stack or start Building.</p>"},{"location":"architecture/technology/","title":"Technology Stack","text":""},{"location":"architecture/technology/#programming-languages","title":"Programming Languages","text":""},{"location":"architecture/technology/#nodejs-services","title":"Node.js Services","text":"<ul> <li>Frontend Service: Express.js web framework</li> <li>Slots Service: Node.js with gRPC</li> <li>Blackjack Service: Node.js with gRPC</li> <li>Dashboard Service: Express.js API server</li> <li>Version: Node.js 18+</li> </ul>"},{"location":"architecture/technology/#python-services","title":"Python Services","text":"<ul> <li>Roulette Service: Python 3.11+ with Flask</li> <li>gRPC: grpcio and grpcio-tools</li> <li>Dependencies: requirements.txt</li> </ul>"},{"location":"architecture/technology/#go-services","title":"Go Services","text":"<ul> <li>Dice Service: Go 1.21+</li> <li>gRPC: google.golang.org/grpc</li> <li>Modules: go.mod/go.sum</li> </ul>"},{"location":"architecture/technology/#java-services","title":"Java Services","text":"<ul> <li>Scoring Service: Java 17 with Spring Boot 3.2.0</li> <li>Build Tool: Maven</li> <li>Framework: Spring Data JPA</li> </ul>"},{"location":"architecture/technology/#observability-technologies","title":"Observability Technologies","text":""},{"location":"architecture/technology/#opentelemetry","title":"OpenTelemetry","text":"<ul> <li>Version: 1.31.0 (Java), Latest (Node.js/Python/Go)</li> <li>Protocol: gRPC (OTLP)</li> <li>Exporters: </li> <li><code>@opentelemetry/exporter-otlp-grpc</code> (Node.js)</li> <li><code>opentelemetry-exporter-otlp-proto-grpc</code> (Python)</li> <li><code>go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc</code> (Go)</li> <li><code>opentelemetry-exporter-otlp</code> (Java)</li> <li>Instrumentation: Auto-instrumentation for HTTP, Express, gRPC, Fetch</li> </ul>"},{"location":"architecture/technology/#opentelemetry-collector","title":"OpenTelemetry Collector","text":"<ul> <li>Endpoint: <code>otel-collector.default.svc.cluster.local:4317</code></li> <li>Protocol: gRPC</li> <li>Purpose: Receives and forwards telemetry data</li> </ul>"},{"location":"architecture/technology/#feature-flag-technologies","title":"Feature Flag Technologies","text":""},{"location":"architecture/technology/#openfeature","title":"OpenFeature","text":"<ul> <li>SDK: <code>@openfeature/server-sdk</code> (Node.js)</li> <li>Provider: <code>@openfeature/flagd-provider</code></li> <li>Operator: OpenFeature Operator (Kubernetes)</li> </ul>"},{"location":"architecture/technology/#flagd","title":"flagd","text":"<ul> <li>Version: Latest (via OpenFeature Operator)</li> <li>Port: 8014 (gRPC), 8015 (Management)</li> <li>Protocol: gRPC</li> <li>Configuration: Kubernetes CRDs</li> </ul>"},{"location":"architecture/technology/#data-storage","title":"Data Storage","text":""},{"location":"architecture/technology/#redis","title":"Redis","text":"<ul> <li>Purpose: Game state, session cache, balance cache</li> <li>Client Libraries:</li> <li>Node.js: <code>redis</code> package</li> <li>Python: <code>redis-py</code></li> <li>Go: <code>github.com/redis/go-redis/v9</code></li> <li>Port: 6379</li> </ul>"},{"location":"architecture/technology/#postgresql","title":"PostgreSQL","text":"<ul> <li>Purpose: Persistent game results and scores</li> <li>Driver: </li> <li>Java: <code>org.postgresql:postgresql</code></li> <li>Spring Data JPA for ORM</li> <li>Port: 5432</li> <li>Schema: Managed by Hibernate DDL</li> </ul>"},{"location":"architecture/technology/#container-orchestration","title":"Container &amp; Orchestration","text":""},{"location":"architecture/technology/#docker","title":"Docker","text":"<ul> <li>Base Images:</li> <li>Node.js: <code>node:18-alpine</code></li> <li>Python: <code>python:3.11-slim</code></li> <li>Go: <code>golang:1.21-alpine</code></li> <li>Java: <code>eclipse-temurin:17-jre-alpine</code></li> <li>Playwright: <code>mcr.microsoft.com/playwright:v1.40.0-focal</code></li> <li>k6: <code>grafana/k6:latest</code></li> </ul>"},{"location":"architecture/technology/#kubernetes","title":"Kubernetes","text":"<ul> <li>API Version: v1</li> <li>Resources: Deployments, Services, Jobs, ConfigMaps, Secrets</li> <li>Gateway API: For ingress routing</li> </ul>"},{"location":"architecture/technology/#helm","title":"Helm","text":"<ul> <li>Version: 3.x</li> <li>Chart: <code>vegas-casino</code></li> <li>Dependencies: None (OpenFeature Operator installed separately)</li> </ul>"},{"location":"architecture/technology/#build-tools","title":"Build Tools","text":""},{"location":"architecture/technology/#make","title":"Make","text":"<ul> <li>Purpose: Build automation</li> <li>Targets: Docker build, push, testing</li> <li>Builder: Podman or Docker</li> </ul>"},{"location":"architecture/technology/#maven","title":"Maven","text":"<ul> <li>Purpose: Java/Spring Boot builds</li> <li>Version: 3.x</li> <li>Configuration: pom.xml</li> </ul>"},{"location":"architecture/technology/#npmyarn","title":"npm/yarn","text":"<ul> <li>Purpose: Node.js dependency management</li> <li>Files: package.json</li> </ul>"},{"location":"architecture/technology/#pip","title":"pip","text":"<ul> <li>Purpose: Python dependency management</li> <li>Files: requirements.txt</li> </ul>"},{"location":"architecture/technology/#go-mod","title":"go mod","text":"<ul> <li>Purpose: Go dependency management</li> <li>Files: go.mod, go.sum</li> </ul>"},{"location":"architecture/technology/#testing-tools","title":"Testing Tools","text":""},{"location":"architecture/technology/#playwright","title":"Playwright","text":"<ul> <li>Version: 1.40.0</li> <li>Purpose: Browser automation and E2E testing</li> <li>Browsers: Chromium (headless)</li> </ul>"},{"location":"architecture/technology/#k6","title":"k6","text":"<ul> <li>Version: Latest</li> <li>Purpose: Load and performance testing</li> <li>Metrics: Built-in + custom metrics</li> </ul>"},{"location":"architecture/technology/#development-tools","title":"Development Tools","text":""},{"location":"architecture/technology/#protocol-buffers","title":"Protocol Buffers","text":"<ul> <li>Purpose: gRPC service definitions</li> <li>Compiler: protoc</li> <li>Languages: Go, Python, Node.js</li> </ul>"},{"location":"architecture/technology/#git","title":"Git","text":"<ul> <li>Version Control: Git</li> <li>Workflow: Feature branches</li> </ul> <p>Next: Learn how to Build the Project or explore Testing.</p>"},{"location":"deployment/","title":"Deployment Overview","text":"<p>The Vegas Casino application can be deployed to Kubernetes using either:</p> <ol> <li>Helm Charts (Recommended) - Declarative, configurable deployment</li> <li>Kubernetes Manifests - Direct YAML files</li> </ol>"},{"location":"deployment/#deployment-options","title":"Deployment Options","text":"<ul> <li>Helm Charts - Recommended way to deploy using Helm (\u2705 Current &amp; Complete)</li> <li>Kubernetes Manifests - Direct Kubernetes manifest deployment (\u26a0\ufe0f See k8s/ vs Helm comparison)</li> <li>k8s/ vs Helm Comparison - Differences between k8s/ directory and Helm chart</li> <li>OpenFeature Operator - Feature flag management setup</li> <li>CI/CD and Releases - GitHub Actions workflows, creating releases, and updating environments</li> </ul>"},{"location":"deployment/#prerequisites","title":"Prerequisites","text":"<p>Before deploying, ensure you have:</p> <ul> <li>\u2705 Kubernetes cluster (v1.24+)</li> <li>\u2705 kubectl configured</li> <li>\u2705 Helm 3.x installed (for Helm deployment)</li> <li>\u2705 OpenFeature Operator installed (required!)</li> <li>\u2705 Gateway API installed (for ingress)</li> <li>\u2705 Docker images built and pushed to registry</li> </ul>"},{"location":"deployment/#deployment-order","title":"Deployment Order","text":"<pre><code>flowchart TD\n    Start([Start Deployment]) --&gt; CheckPrereqs{Check Prerequisites}\n    CheckPrereqs --&gt;|Missing| InstallPrereqs[Install Prerequisites]\n    InstallPrereqs --&gt; InstallOF[1. Install OpenFeature Operator]\n    CheckPrereqs --&gt;|Ready| InstallOF\n\n    InstallOF --&gt; WaitOF[Wait for Operator Ready]\n    WaitOF --&gt; InstallGateway[2. Install Gateway API]\n    InstallGateway --&gt; DeployApp{Choose Deployment Method}\n\n    DeployApp --&gt;|Helm| HelmDeploy[3a. Deploy via Helm]\n    DeployApp --&gt;|Manifests| ManifestDeploy[3b. Deploy via Manifests]\n\n    HelmDeploy --&gt; Verify[4. Verify Deployment]\n    ManifestDeploy --&gt; Verify\n\n    Verify --&gt; CheckPods[Check Pods]\n    CheckPods --&gt; CheckServices[Check Services]\n    CheckServices --&gt; CheckGateway[Check Gateway]\n    CheckGateway --&gt; CheckFlags[Check Feature Flags]\n    CheckFlags --&gt; Complete([Deployment Complete])\n\n    style InstallOF fill:#dc2626,stroke:#b91c1c,color:#fff\n    style WaitOF fill:#f59e0b,stroke:#d97706,color:#fff\n    style Complete fill:#10b981,stroke:#059669,color:#fff</code></pre>"},{"location":"deployment/#1-install-openfeature-operator-required-first","title":"1. Install OpenFeature Operator (REQUIRED FIRST!)","text":"<p>\u26a0\ufe0f IMPORTANT: The OpenFeature Operator must be installed before deploying the application.</p> <pre><code># Install OpenFeature Operator\nhelm repo add openfeature https://open-feature.github.io/open-feature-operator\nhelm repo update\nhelm install open-feature-operator openfeature/open-feature-operator \\\n  --namespace open-feature-system \\\n  --create-namespace\n</code></pre> <p>Wait for operator to be ready: <pre><code>kubectl wait --for=condition=ready pod \\\n  -l control-plane=controller-manager \\\n  -n open-feature-system \\\n  --timeout=90s\n</code></pre></p>"},{"location":"deployment/#2-install-gateway-api-if-not-already-installed","title":"2. Install Gateway API (if not already installed)","text":"<pre><code># Install Gateway API CRDs\nkubectl apply -f https://github.com/kubernetes-sigs/gateway-api/releases/download/v1.0.0/standard-install.yaml\n</code></pre>"},{"location":"deployment/#3-deploy-application","title":"3. Deploy Application","text":"<p>Choose your deployment method: - Helm Charts (Recommended) - Kubernetes Manifests</p>"},{"location":"deployment/#post-deployment","title":"Post-Deployment","text":"<p>After deployment, verify:</p> <ol> <li> <p>Pods are running:    <pre><code>kubectl get pods -n vegas-casino\n</code></pre></p> </li> <li> <p>Services are available:    <pre><code>kubectl get svc -n vegas-casino\n</code></pre></p> </li> <li> <p>Gateway is accessible:    <pre><code>kubectl get gateway -n vegas-casino\nkubectl get httproute -n vegas-casino\n</code></pre></p> </li> <li> <p>OpenFeature resources:    <pre><code>kubectl get featureflag -n vegas-casino\nkubectl get featureflagsource -n vegas-casino\n</code></pre></p> </li> </ol>"},{"location":"deployment/#accessing-the-application","title":"Accessing the Application","text":""},{"location":"deployment/#via-gateway-external-ip","title":"Via Gateway External IP","text":"<pre><code># Get external IP\nkubectl get gateway vegas-casino-gateway -n vegas-casino -o jsonpath='{.status.addresses[0].value}'\n\n# Access frontend\ncurl http://&lt;EXTERNAL_IP&gt;/\n\n# Access dashboard\ncurl http://&lt;EXTERNAL_IP&gt;/dashboard\n</code></pre>"},{"location":"deployment/#via-port-forward-development","title":"Via Port Forward (Development)","text":"<pre><code># Forward frontend port\nkubectl port-forward -n vegas-casino svc/vegas-casino-frontend 3000:3000\n\n# Access at http://localhost:3000\n</code></pre>"},{"location":"deployment/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/#pods-not-starting","title":"Pods Not Starting","text":"<pre><code># Check pod status\nkubectl describe pod &lt;pod-name&gt; -n vegas-casino\n\n# Check logs\nkubectl logs &lt;pod-name&gt; -n vegas-casino\n</code></pre>"},{"location":"deployment/#openfeature-issues","title":"OpenFeature Issues","text":"<pre><code># Verify operator is running\nkubectl get pods -n open-feature-system\n\n# Check FeatureFlagSource\nkubectl describe featureflagsource -n vegas-casino\n\n# Check flagd sidecars\nkubectl get pods -n vegas-casino -o jsonpath='{.items[*].spec.containers[*].name}'\n</code></pre>"},{"location":"deployment/#service-connectivity","title":"Service Connectivity","text":"<pre><code># Test service connectivity\nkubectl run -it --rm debug --image=curlimages/curl --restart=Never -- \\\n  curl http://vegas-casino-frontend:3000/health\n</code></pre> <p>Next: Learn about Helm Deployment or Kubernetes Manifests.</p>"},{"location":"deployment/ci-cd/","title":"CI/CD and Release Management","text":"<p>This document explains the GitHub Actions workflows, how to create releases, and how to update the codespace environment.</p>"},{"location":"deployment/ci-cd/#github-actions-workflows","title":"GitHub Actions Workflows","text":"<p>The project uses several GitHub Actions workflows for continuous integration, security scanning, and container image management.</p>"},{"location":"deployment/ci-cd/#workflow-overview","title":"Workflow Overview","text":"Workflow Purpose Triggers <code>ci-cd.yml</code> Full CI/CD pipeline with tests, builds, security scans, and SBOM generation Push to main/V2-Otel, PRs, manual dispatch <code>docker-build.yml</code> Build and push Docker images to GitHub Container Registry Push to main/V2-Otel, tags (v*), manual dispatch <code>security-scan.yml</code> Security vulnerability scanning with Trivy and CodeQL Push to main/V2-Otel, PRs, weekly schedule <code>sbom.yml</code> Generate Software Bill of Materials for container images Push to main/V2-Otel, tags (v*), manual dispatch"},{"location":"deployment/ci-cd/#cicd-pipeline-ci-cdyml","title":"CI/CD Pipeline (<code>ci-cd.yml</code>)","text":"<p>The main CI/CD pipeline performs the following steps:</p>"},{"location":"deployment/ci-cd/#1-test-job","title":"1. Test Job","text":"<ul> <li>Runs: On every push and pull request</li> <li>Purpose: Run unit tests for all services</li> <li>Languages: Node.js, Python, Go, Java</li> <li>Services Tested:</li> <li>Gateway (Node.js)</li> <li>Slots (Node.js)</li> <li>Blackjack (Node.js)</li> <li>Frontend (Node.js)</li> <li>Roulette (Python)</li> <li>Dice (Go)</li> </ul>"},{"location":"deployment/ci-cd/#2-build-job","title":"2. Build Job","text":"<ul> <li>Runs: After tests pass</li> <li>Purpose: Build Docker images for all services</li> <li>Registry: GitHub Container Registry (<code>ghcr.io</code>)</li> <li>Image Naming: <code>{registry}/{owner}/vegasapp-{service}:{tag}</code></li> <li>Services Built:</li> <li>gateway</li> <li>slots</li> <li>blackjack</li> <li>frontend</li> <li>roulette</li> <li>dice</li> <li>scoring</li> <li>dashboard</li> <li>playwright</li> <li>k6</li> </ul>"},{"location":"deployment/ci-cd/#3-security-scan-job","title":"3. Security Scan Job","text":"<ul> <li>Runs: After build completes</li> <li>Purpose: Scan images and code for vulnerabilities</li> <li>Tools:</li> <li>Trivy (container and filesystem scanning)</li> <li>CodeQL (code analysis)</li> <li>Dependency Review (for PRs)</li> <li>Severity Levels: CRITICAL, HIGH, MEDIUM</li> </ul>"},{"location":"deployment/ci-cd/#4-sbom-generation-job","title":"4. SBOM Generation Job","text":"<ul> <li>Runs: After build completes</li> <li>Purpose: Generate Software Bill of Materials</li> <li>Formats: SPDX JSON, SPDX, CycloneDX JSON</li> <li>Storage: Uploaded as artifacts and attached to releases</li> </ul>"},{"location":"deployment/ci-cd/#5-build-summary-job","title":"5. Build Summary Job","text":"<ul> <li>Runs: After all jobs complete</li> <li>Purpose: Provide summary of build status</li> </ul>"},{"location":"deployment/ci-cd/#docker-build-workflow-docker-buildyml","title":"Docker Build Workflow (<code>docker-build.yml</code>)","text":"<p>This workflow focuses specifically on building and pushing Docker images.</p> <p>Features: - Builds all services in parallel using matrix strategy - Pushes to GitHub Container Registry (<code>ghcr.io</code>) - Supports manual dispatch with service selection - Automatic tagging based on branch, PR, or tag - Build caching for faster builds</p> <p>Image Tags Generated: - Branch name (e.g., <code>main</code>) - PR number (e.g., <code>pr-123</code>) - Semantic version from tags (e.g., <code>v0.39.0</code>, <code>0.39</code>) - SHA prefix (e.g., <code>main-abc1234</code>) - <code>latest</code> (only for default branch)</p> <p>Manual Dispatch: You can manually trigger builds for specific services: 1. Go to Actions &gt; Docker Build and Push 2. Click Run workflow 3. Select service to build (or \"all\" for all services) 4. Optionally specify image tag</p>"},{"location":"deployment/ci-cd/#security-scanning-security-scanyml","title":"Security Scanning (<code>security-scan.yml</code>)","text":"<p>Features: - Trivy: Scans container images and filesystem - CodeQL: Static code analysis for JavaScript, Python, Java, Go - Dependency Review: Checks PR dependencies for vulnerabilities - Scheduled: Runs weekly on Sundays - Reporting: Results uploaded to GitHub Security tab</p>"},{"location":"deployment/ci-cd/#sbom-generation-sbomyml","title":"SBOM Generation (<code>sbom.yml</code>)","text":"<p>Features: - Generates SBOMs in multiple formats (SPDX, CycloneDX) - Attaches SBOMs to GitHub releases - Stores artifacts for 90 days - Can be triggered manually</p>"},{"location":"deployment/ci-cd/#creating-a-new-release","title":"Creating a New Release","text":""},{"location":"deployment/ci-cd/#step-1-update-version-numbers","title":"Step 1: Update Version Numbers","text":"<p>Before creating a release, update the version numbers in:</p> <ol> <li> <p>Makefile:    <pre><code>IMAGE_TAG ?= 0.40  # Update to new version\n</code></pre></p> </li> <li> <p>Helm Chart (<code>helm/vegas-casino/values.yaml</code>):    <pre><code>global:\n  imageTag: \"0.40\"  # Update to new version\n</code></pre></p> </li> <li> <p>Commit and Push:    <pre><code>git add Makefile helm/vegas-casino/values.yaml\ngit commit -m \"Bump version to 0.40\"\ngit push origin main\n</code></pre></p> </li> </ol>"},{"location":"deployment/ci-cd/#step-2-create-git-tag","title":"Step 2: Create Git Tag","text":"<p>Create a new tag for the release:</p> <pre><code># Create annotated tag\ngit tag -a v0.40.0 -m \"Release version 0.40.0\"\n\n# Push tag to remote\ngit push origin v0.40.0\n</code></pre> <p>Tag Format: Use semantic versioning (e.g., <code>v0.40.0</code>, <code>v1.0.0</code>)</p>"},{"location":"deployment/ci-cd/#step-3-github-actions-automatically-builds","title":"Step 3: GitHub Actions Automatically Builds","text":"<p>When you push a tag starting with <code>v</code>, the workflows automatically: 1. Build all Docker images 2. Tag images with the version number 3. Push to GitHub Container Registry 4. Generate SBOMs 5. Attach SBOMs to the release</p>"},{"location":"deployment/ci-cd/#step-4-create-github-release","title":"Step 4: Create GitHub Release","text":"<ol> <li>Go to Releases in your GitHub repository</li> <li>Click Draft a new release</li> <li>Select the tag you just created (e.g., <code>v0.40.0</code>)</li> <li>Fill in release title and description</li> <li>Click Publish release</li> </ol> <p>Release Notes Template: <pre><code>## What's New in v0.40.0\n\n### Features\n- Feature 1\n- Feature 2\n\n### Bug Fixes\n- Fix 1\n- Fix 2\n\n### Improvements\n- Improvement 1\n\n### Docker Images\nAll images are available at `ghcr.io/{owner}/vegasapp-{service}:0.40.0`\n</code></pre></p>"},{"location":"deployment/ci-cd/#updating-codespace-environment","title":"Updating Codespace Environment","text":"<p>The codespace environment can be updated to use the latest release using Helm.</p>"},{"location":"deployment/ci-cd/#prerequisites","title":"Prerequisites","text":"<ul> <li>Access to the Kubernetes cluster</li> <li><code>kubectl</code> configured</li> <li><code>helm</code> installed</li> <li>Required secrets and configuration</li> </ul>"},{"location":"deployment/ci-cd/#method-1-using-deployment-script","title":"Method 1: Using Deployment Script","text":"<p>The <code>codespace/deployment.sh</code> script handles the full deployment:</p> <pre><code>cd codespace\n./deployment.sh \\\n  --clustername \"my-cluster\" \\\n  --dtid \"abc12345\" \\\n  --environment \"live\" \\\n  --dtoperatortoken \"dt0c01.******\" \\\n  --dtingesttoken \"dt0c01.******\" \\\n  --oauthclientid \"dt0s10.******\" \\\n  --oauthclientsecret \"******\" \\\n  --oauthclienturn \"urn:dtenvironment:abc12345\"\n</code></pre> <p>The script will: 1. Install required operators (OpenFeature, Dynatrace, OpenTelemetry) 2. Deploy the Vegas Casino application using Helm 3. Configure services and networking</p>"},{"location":"deployment/ci-cd/#method-2-manual-helm-upgrade","title":"Method 2: Manual Helm Upgrade","text":"<p>To update to a specific version:</p> <pre><code># Update Helm chart repository (if using external repo)\nhelm repo update\n\n# Upgrade to specific version\nhelm upgrade vegas-casino ./helm/vegas-casino \\\n  --namespace vegas-casino \\\n  --set global.imageTag=\"0.40\" \\\n  --set global.imageRegistry=\"ghcr.io/{owner}/vegasapp\" \\\n  --reuse-values\n</code></pre>"},{"location":"deployment/ci-cd/#method-3-update-valuesyaml-and-upgrade","title":"Method 3: Update values.yaml and Upgrade","text":"<ol> <li> <p>Edit Helm values:    <pre><code># Edit helm/vegas-casino/values.yaml\n# Update:\nglobal:\n  imageTag: \"0.40\"\n  imageRegistry: \"ghcr.io/{owner}/vegasapp\"\n</code></pre></p> </li> <li> <p>Upgrade deployment:    <pre><code>helm upgrade vegas-casino ./helm/vegas-casino \\\n  --namespace vegas-casino \\\n  --create-namespace\n</code></pre></p> </li> </ol>"},{"location":"deployment/ci-cd/#method-4-update-individual-services","title":"Method 4: Update Individual Services","text":"<p>To update specific services without affecting others:</p> <pre><code># Update only frontend service\nhelm upgrade vegas-casino ./helm/vegas-casino \\\n  --namespace vegas-casino \\\n  --set frontend.image.tag=\"0.40\" \\\n  --reuse-values\n\n# Update multiple services\nhelm upgrade vegas-casino ./helm/vegas-casino \\\n  --namespace vegas-casino \\\n  --set frontend.image.tag=\"0.40\" \\\n  --set slots.image.tag=\"0.40\" \\\n  --set roulette.image.tag=\"0.40\" \\\n  --reuse-values\n</code></pre>"},{"location":"deployment/ci-cd/#verifying-the-update","title":"Verifying the Update","text":"<p>After updating, verify the deployment:</p> <pre><code># Check pod status\nkubectl get pods -n vegas-casino\n\n# Check image versions\nkubectl get pods -n vegas-casino -o jsonpath='{range .items[*]}{.metadata.name}{\"\\t\"}{.spec.containers[*].image}{\"\\n\"}{end}'\n\n# Check Helm release status\nhelm status vegas-casino -n vegas-casino\n\n# View release history\nhelm history vegas-casino -n vegas-casino\n</code></pre>"},{"location":"deployment/ci-cd/#rollback-if-needed","title":"Rollback if Needed","text":"<p>If the update causes issues, rollback to previous version:</p> <pre><code># Rollback to previous release\nhelm rollback vegas-casino -n vegas-casino\n\n# Rollback to specific revision\nhelm rollback vegas-casino 2 -n vegas-casino  # Rollback to revision 2\n\n# View rollback history\nhelm history vegas-casino -n vegas-casino\n</code></pre>"},{"location":"deployment/ci-cd/#image-registry-configuration","title":"Image Registry Configuration","text":""},{"location":"deployment/ci-cd/#github-container-registry-ghcrio","title":"GitHub Container Registry (ghcr.io)","text":"<p>Images are pushed to GitHub Container Registry by default: - Registry: <code>ghcr.io</code> - Format: <code>ghcr.io/{owner}/vegasapp-{service}:{tag}</code> - Authentication: Uses <code>GITHUB_TOKEN</code> automatically</p>"},{"location":"deployment/ci-cd/#pulling-images","title":"Pulling Images","text":"<p>To pull images from GitHub Container Registry:</p> <pre><code># Login to GitHub Container Registry\necho $GITHUB_TOKEN | docker login ghcr.io -u USERNAME --password-stdin\n\n# Pull specific image\ndocker pull ghcr.io/{owner}/vegasapp-frontend:0.40\n</code></pre>"},{"location":"deployment/ci-cd/#using-images-in-helm","title":"Using Images in Helm","text":"<p>Update <code>helm/vegas-casino/values.yaml</code>:</p> <pre><code>global:\n  imageRegistry: ghcr.io/{owner}/vegasapp\n  imageTag: \"0.40\"\n  imagePullPolicy: IfNotPresent\n</code></pre> <p>Or use <code>--set</code> flags:</p> <pre><code>helm upgrade vegas-casino ./helm/vegas-casino \\\n  --set global.imageRegistry=\"ghcr.io/{owner}/vegasapp\" \\\n  --set global.imageTag=\"0.40\"\n</code></pre>"},{"location":"deployment/ci-cd/#best-practices","title":"Best Practices","text":""},{"location":"deployment/ci-cd/#version-management","title":"Version Management","text":"<ol> <li>Use Semantic Versioning: Follow <code>MAJOR.MINOR.PATCH</code> format</li> <li>Tag Releases: Always create git tags for releases</li> <li>Update Documentation: Update version numbers in docs</li> <li>Changelog: Maintain a changelog for each release</li> </ol>"},{"location":"deployment/ci-cd/#deployment-strategy","title":"Deployment Strategy","text":"<ol> <li>Test First: Test new versions in a staging environment</li> <li>Gradual Rollout: Consider using Helm's <code>replicaCount</code> for gradual rollouts</li> <li>Monitor: Watch logs and metrics after deployment</li> <li>Rollback Plan: Always have a rollback plan ready</li> </ol>"},{"location":"deployment/ci-cd/#security","title":"Security","text":"<ol> <li>Scan Images: Always review security scan results before deploying</li> <li>Update Dependencies: Keep dependencies up to date</li> <li>Review SBOMs: Review Software Bill of Materials for vulnerabilities</li> <li>Use Secrets: Never commit secrets to the repository</li> </ol>"},{"location":"deployment/ci-cd/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/ci-cd/#images-not-found","title":"Images Not Found","text":"<p>If Helm can't pull images:</p> <pre><code># Check image exists\ndocker pull ghcr.io/{owner}/vegasapp-frontend:0.40\n\n# Verify image pull secrets\nkubectl get secrets -n vegas-casino\n\n# Check pod events\nkubectl describe pod &lt;pod-name&gt; -n vegas-casino\n</code></pre>"},{"location":"deployment/ci-cd/#build-failures","title":"Build Failures","text":"<p>If GitHub Actions builds fail:</p> <ol> <li>Check workflow logs in Actions tab</li> <li>Verify Dockerfile syntax</li> <li>Check for dependency issues</li> <li>Review build cache</li> </ol>"},{"location":"deployment/ci-cd/#deployment-issues","title":"Deployment Issues","text":"<p>If Helm upgrade fails:</p> <pre><code># Check release status\nhelm status vegas-casino -n vegas-casino\n\n# View failed resources\nkubectl get all -n vegas-casino\n\n# Check pod logs\nkubectl logs &lt;pod-name&gt; -n vegas-casino\n\n# Dry-run to see what would change\nhelm upgrade vegas-casino ./helm/vegas-casino --dry-run --debug\n</code></pre> <p>Next: Learn about Helm Deployment or Kubernetes Manifests.</p>"},{"location":"deployment/helm/","title":"Helm Deployment","text":""},{"location":"deployment/helm/#overview","title":"Overview","text":"<p>Helm is the recommended way to deploy the Vegas Casino application. It provides:</p> <ul> <li>\u2705 Configuration management via values.yaml</li> <li>\u2705 Template-based resource generation</li> <li>\u2705 Dependency management</li> <li>\u2705 Easy upgrades and rollbacks</li> </ul>"},{"location":"deployment/helm/#prerequisites","title":"Prerequisites","text":"<ol> <li>Helm 3.x installed</li> <li>OpenFeature Operator installed (see OpenFeature Operator)</li> <li>Gateway API installed</li> <li>Docker images built and available</li> </ol>"},{"location":"deployment/helm/#quick-start","title":"Quick Start","text":"<pre><code># Install with default values\nhelm install vegas-casino ./helm/vegas-casino\n\n# Or with custom values\nhelm install vegas-casino ./helm/vegas-casino \\\n  --set global.imageTag=0.10 \\\n  --set frontend.replicaCount=2\n</code></pre>"},{"location":"deployment/helm/#configuration","title":"Configuration","text":""},{"location":"deployment/helm/#key-values","title":"Key Values","text":"<p>Edit <code>helm/vegas-casino/values.yaml</code> or use <code>--set</code> flags:</p> <pre><code>global:\n  imageRegistry: hrexed/vegasapp\n  imageTag: \"0.39\"\n  namespace: vegas-casino\n\nfrontend:\n  enabled: true\n  replicaCount: 2\n\nopentelemetry:\n  enabled: true\n  exporter:\n    endpoint: \"otel-collector.default.svc.cluster.local:4317\"\n    protocol: \"grpc\"\n\nopenfeature:\n  enabled: true\n</code></pre>"},{"location":"deployment/helm/#custom-values-file","title":"Custom Values File","text":"<p>Create <code>my-values.yaml</code>:</p> <pre><code>global:\n  imageTag: \"0.11\"\n\nfrontend:\n  replicaCount: 3\n\nplaywright:\n  enabled: true\n  runContinuously: \"true\"\n\nk6:\n  enabled: true\n  vus: \"50\"\n  duration: \"30m\"\n</code></pre> <p>Deploy with custom values: <pre><code>helm install vegas-casino ./helm/vegas-casino -f my-values.yaml\n</code></pre></p>"},{"location":"deployment/helm/#deployment-steps","title":"Deployment Steps","text":""},{"location":"deployment/helm/#1-install-openfeature-operator","title":"1. Install OpenFeature Operator","text":"<p>\u26a0\ufe0f CRITICAL: Must be done first!</p> <pre><code>helm repo add openfeature https://open-feature.github.io/open-feature-operator\nhelm repo update\nhelm install open-feature-operator openfeature/open-feature-operator \\\n  --namespace open-feature-system \\\n  --create-namespace\n</code></pre>"},{"location":"deployment/helm/#2-deploy-application","title":"2. Deploy Application","text":"<pre><code># Install\nhelm install vegas-casino ./helm/vegas-casino\n\n# Or upgrade if already installed\nhelm upgrade vegas-casino ./helm/vegas-casino\n</code></pre>"},{"location":"deployment/helm/#3-verify-deployment","title":"3. Verify Deployment","text":"<pre><code># Check release status\nhelm status vegas-casino\n\n# List all resources\nhelm get manifest vegas-casino\n\n# Check pods\nkubectl get pods -n vegas-casino\n</code></pre>"},{"location":"deployment/helm/#common-operations","title":"Common Operations","text":""},{"location":"deployment/helm/#upgrade-deployment","title":"Upgrade Deployment","text":"<pre><code># Upgrade with new image tag\nhelm upgrade vegas-casino ./helm/vegas-casino \\\n  --set global.imageTag=0.39\n\n# Upgrade with values file\nhelm upgrade vegas-casino ./helm/vegas-casino -f my-values.yaml\n</code></pre>"},{"location":"deployment/helm/#rollback","title":"Rollback","text":"<pre><code># List revisions\nhelm history vegas-casino\n\n# Rollback to previous version\nhelm rollback vegas-casino\n\n# Rollback to specific revision\nhelm rollback vegas-casino 2\n</code></pre>"},{"location":"deployment/helm/#uninstall","title":"Uninstall","text":"<pre><code># Uninstall release\nhelm uninstall vegas-casino\n\n# Note: This does NOT uninstall OpenFeature Operator\n</code></pre>"},{"location":"deployment/helm/#configuration-examples","title":"Configuration Examples","text":""},{"location":"deployment/helm/#enable-all-services","title":"Enable All Services","text":"<pre><code>frontend:\n  enabled: true\nslots:\n  enabled: true\nroulette:\n  enabled: true\ndice:\n  enabled: true\nblackjack:\n  enabled: true\nscoring:\n  enabled: true\ndashboard:\n  enabled: true\nredis:\n  enabled: true\npostgresql:\n  enabled: true\n</code></pre>"},{"location":"deployment/helm/#configure-resource-limits","title":"Configure Resource Limits","text":"<pre><code>frontend:\n  resources:\n    requests:\n      memory: \"512Mi\"\n      cpu: \"200m\"\n    limits:\n      memory: \"1Gi\"\n      cpu: \"500m\"\n</code></pre>"},{"location":"deployment/helm/#configure-feature-flags","title":"Configure Feature Flags","text":"<pre><code>openfeature:\n  enabled: true\n\nflagd:\n  slots:\n    \"progressive-jackpot\":\n      state: \"ENABLED\"\n      defaultVariant: \"true\"\n  roulette:\n    \"cheat-detection\":\n      state: \"ENABLED\"\n      defaultVariant: \"true\"\n</code></pre>"},{"location":"deployment/helm/#external-database","title":"External Database","text":"<pre><code>postgresql:\n  enabled: false  # Use external database\n\nscoring:\n  env:\n    DB_HOST: \"external-postgres.example.com\"\n    DB_PORT: \"5432\"\n    DB_NAME: \"vegas_casino\"\n    DB_USER: \"vegas_user\"\n    DB_PASSWORD: \"password\"\n</code></pre>"},{"location":"deployment/helm/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/helm/#release-stuck","title":"Release Stuck","text":"<pre><code># Check release status\nhelm status vegas-casino\n\n# Force delete (if needed)\nhelm uninstall vegas-casino --no-hooks\n</code></pre>"},{"location":"deployment/helm/#resources-not-created","title":"Resources Not Created","text":"<pre><code># Check if values are correct\nhelm template vegas-casino ./helm/vegas-casino\n\n# Dry-run to see what would be created\nhelm install vegas-casino ./helm/vegas-casino --dry-run --debug\n</code></pre>"},{"location":"deployment/helm/#image-pull-errors","title":"Image Pull Errors","text":"<pre><code># Verify image exists\ndocker pull hrexed/vegasapp-frontend:0.39\n\n# Check image pull secrets\nkubectl get secrets -n vegas-casino\n</code></pre> <p>Next: Learn about Kubernetes Manifests or OpenFeature Operator.</p>"},{"location":"deployment/k8s-vs-helm/","title":"k8s/ Directory vs Helm Deployment Comparison","text":"<p>This document compares the <code>k8s/</code> directory manifests with the Helm chart deployment to help you understand the differences and choose the appropriate deployment method.</p>"},{"location":"deployment/k8s-vs-helm/#overview","title":"Overview","text":"Aspect k8s/ Directory Helm Chart Purpose Direct Kubernetes manifests Templated Helm charts Configuration Hardcoded values in YAML Configurable via <code>values.yaml</code> Service Naming <code>vegas-{service}-service</code> <code>vegas-casino-{service}</code> (configurable) Image Tags <code>latest</code> (hardcoded) Configurable via <code>global.imageTag</code> Infrastructure Missing Redis, PostgreSQL Includes Redis, PostgreSQL Feature Flags Not included OpenFeature Operator integration Testing Tools Not included k6 and Playwright deployments"},{"location":"deployment/k8s-vs-helm/#key-differences","title":"Key Differences","text":""},{"location":"deployment/k8s-vs-helm/#1-missing-infrastructure-components","title":"1. Missing Infrastructure Components","text":"<p>The <code>k8s/</code> directory is missing the following components that are present in Helm:</p>"},{"location":"deployment/k8s-vs-helm/#redis","title":"Redis","text":"<ul> <li>Helm: Includes <code>redis-deployment.yaml</code> and <code>redis-service.yaml</code></li> <li>k8s/: \u274c Not present</li> <li>Impact: Frontend service cannot store user balances or profiles</li> <li>Required for: User balance management, profile storage</li> </ul>"},{"location":"deployment/k8s-vs-helm/#postgresql","title":"PostgreSQL","text":"<ul> <li>Helm: Includes <code>postgresql-deployment.yaml</code> and <code>postgresql-service.yaml</code></li> <li>k8s/: \u274c Not present</li> <li>Impact: Scoring service cannot persist game results</li> <li>Required for: Game statistics, leaderboards, dashboard data</li> </ul>"},{"location":"deployment/k8s-vs-helm/#openfeature-resources","title":"OpenFeature Resources","text":"<ul> <li>Helm: Includes <code>featureflag.yaml</code>, <code>featureflagsource.yaml</code>, <code>flagd-*.yaml</code></li> <li>k8s/: \u274c Not present</li> <li>Impact: Feature flags will not work</li> <li>Required for: Dynamic feature toggling</li> </ul>"},{"location":"deployment/k8s-vs-helm/#testing-tools","title":"Testing Tools","text":"<ul> <li>Helm: Includes <code>k6-deployment.yaml</code> and <code>playwright-deployment.yaml</code></li> <li>k8s/: \u274c Not present</li> <li>Impact: Cannot run load tests or E2E tests</li> <li>Optional: Testing infrastructure</li> </ul>"},{"location":"deployment/k8s-vs-helm/#2-service-configuration-differences","title":"2. Service Configuration Differences","text":""},{"location":"deployment/k8s-vs-helm/#frontend-service","title":"Frontend Service","text":"<p>k8s/ frontend-deployment.yaml: <pre><code># Missing Redis configuration\n# Missing DASHBOARD_SERVICE_GRPC\n# Uses old service names: vegas-slots-service:50051\n# Missing SCORING_SERVICE_URL\n</code></pre></p> <p>Helm frontend-deployment.yaml: <pre><code># Includes Redis configuration\n- name: REDIS_HOST\n  value: \"vegas-casino-redis\"\n- name: REDIS_PORT\n  value: \"6379\"\n# Includes Dashboard gRPC\n- name: DASHBOARD_SERVICE_GRPC\n  value: \"vegas-casino-dashboard:50055\"\n# Uses correct service names\n- name: SLOTS_SERVICE_GRPC\n  value: \"vegas-casino-slots:50051\"\n</code></pre></p>"},{"location":"deployment/k8s-vs-helm/#game-services","title":"Game Services","text":"<p>k8s/ slots-deployment.yaml: <pre><code># Missing gRPC port exposure\nports:\n  - containerPort: 8081  # HTTP only\n# Missing Redis configuration\n# Missing OpenFeature annotations\n</code></pre></p> <p>Helm slots-deployment.yaml: <pre><code># Includes both HTTP and gRPC ports\nports:\n  - containerPort: 8081  # HTTP\n  - containerPort: 50051 # gRPC\n# Includes Redis configuration\n- name: REDIS_HOST\n  value: \"vegas-casino-redis\"\n# Includes OpenFeature annotations\nannotations:\n  openfeature.dev/enabled: \"true\"\n</code></pre></p>"},{"location":"deployment/k8s-vs-helm/#3-service-naming-convention","title":"3. Service Naming Convention","text":"Component k8s/ Directory Helm Chart Frontend <code>vegas-frontend-service</code> <code>vegas-casino-frontend</code> Slots <code>vegas-slots-service</code> <code>vegas-casino-slots</code> Roulette <code>vegas-roulette-service</code> <code>vegas-casino-roulette</code> Dice <code>vegas-dice-service</code> <code>vegas-casino-dice</code> Blackjack <code>vegas-blackjack-service</code> <code>vegas-casino-blackjack</code> Dashboard <code>vegas-dashboard-service</code> <code>vegas-casino-dashboard</code> Scoring <code>vegas-scoring-service</code> <code>vegas-casino-scoring</code> <p>Impact: Services in <code>k8s/</code> use different DNS names, which may cause connectivity issues if services reference each other.</p>"},{"location":"deployment/k8s-vs-helm/#4-image-configuration","title":"4. Image Configuration","text":"<p>k8s/ Directory: <pre><code>image: vegas-frontend-service:latest  # Hardcoded\n</code></pre></p> <p>Helm Chart: <pre><code>image: \"{{ .Values.global.imageRegistry }}-frontend:{{ .Values.global.imageTag }}\"\n# Example: hrexed/vegasapp-frontend:0.39\n</code></pre></p> <p>Impact: k8s/ directory always uses <code>latest</code> tag, making version management difficult.</p>"},{"location":"deployment/k8s-vs-helm/#5-missing-service-resources","title":"5. Missing Service Resources","text":"<p>The <code>k8s/</code> directory deployments include Service definitions inline, but they may be incomplete:</p> <p>k8s/ frontend-deployment.yaml includes: <pre><code>---\napiVersion: v1\nkind: Service\nmetadata:\n  name: vegas-frontend-service\nspec:\n  ports:\n  - port: 3000\n    targetPort: 3000\n</code></pre></p> <p>Helm has separate service files with gRPC ports: <pre><code># frontend-service.yaml\nports:\n  - port: 3000\n    name: http\n  - port: 50055  # gRPC (if needed)\n    name: grpc\n</code></pre></p>"},{"location":"deployment/k8s-vs-helm/#6-opentelemetry-configuration","title":"6. OpenTelemetry Configuration","text":"<p>k8s/ Directory: - Basic OpenTelemetry configuration - Hardcoded endpoint: <code>http://otel-collector:4318</code> - Missing protocol configuration</p> <p>Helm Chart: - Configurable OpenTelemetry endpoint - Supports both gRPC and HTTP protocols - Configurable via <code>values.yaml</code></p>"},{"location":"deployment/k8s-vs-helm/#recommendations","title":"Recommendations","text":""},{"location":"deployment/k8s-vs-helm/#use-helm-chart-recommended","title":"Use Helm Chart (Recommended)","text":"<p>\u2705 Use Helm when: - You need a complete, production-ready deployment - You want Redis and PostgreSQL included - You need feature flags (OpenFeature) - You want configurable image tags and registries - You need testing tools (k6, Playwright) - You want easy upgrades and rollbacks</p>"},{"location":"deployment/k8s-vs-helm/#use-k8s-directory","title":"Use k8s/ Directory","text":"<p>\u26a0\ufe0f Use k8s/ directory when: - You're doing quick testing or development - You have external Redis/PostgreSQL - You don't need feature flags - You prefer direct kubectl apply - You want minimal dependencies</p>"},{"location":"deployment/k8s-vs-helm/#migration-path","title":"Migration Path","text":"<p>If you're currently using <code>k8s/</code> directory and want to migrate to Helm:</p> <ol> <li> <p>Backup current deployment:    <pre><code>kubectl get all -n vegas-casino -o yaml &gt; backup.yaml\n</code></pre></p> </li> <li> <p>Install Helm chart:    <pre><code>helm install vegas-casino ./helm/vegas-casino\n</code></pre></p> </li> <li> <p>Update service references if you have external services pointing to old names</p> </li> <li> <p>Remove old k8s/ resources (after verifying Helm deployment works)</p> </li> </ol>"},{"location":"deployment/k8s-vs-helm/#what-needs-to-be-updated-in-k8s","title":"What Needs to be Updated in k8s/","text":"<p>If you want to keep using <code>k8s/</code> directory, you should:</p> <ol> <li>Add Redis deployment and service</li> <li>Add PostgreSQL deployment and service</li> <li>Update frontend deployment:</li> <li>Add Redis environment variables</li> <li>Add DASHBOARD_SERVICE_GRPC</li> <li>Update service names to match Helm convention</li> <li>Add SCORING_SERVICE_URL</li> <li>Update game service deployments:</li> <li>Add gRPC port exposure</li> <li>Add Redis environment variables</li> <li>Update service names</li> <li>Add Service resources for gRPC ports</li> <li>Update image tags to use versioned tags instead of <code>latest</code></li> </ol>"},{"location":"deployment/k8s-vs-helm/#current-status","title":"Current Status","text":"<p>k8s/ Directory: \u26a0\ufe0f Outdated - Missing critical infrastructure and configuration</p> <p>Helm Chart: \u2705 Current - Reflects the latest architecture and requirements</p> <p>Recommendation: Use the Helm chart for all deployments. The <code>k8s/</code> directory can be kept for reference or removed if no longer needed.</p>"},{"location":"deployment/manifests/","title":"Kubernetes Manifests","text":""},{"location":"deployment/manifests/#overview","title":"Overview","text":"<p>You can deploy the Vegas Casino application using raw Kubernetes manifests instead of Helm. This gives you full control over the resources but requires manual management.</p>"},{"location":"deployment/manifests/#prerequisites","title":"Prerequisites","text":"<ol> <li>kubectl configured</li> <li>OpenFeature Operator installed (see OpenFeature Operator)</li> <li>Gateway API installed</li> <li>Docker images built and available</li> </ol>"},{"location":"deployment/manifests/#deployment-order","title":"Deployment Order","text":""},{"location":"deployment/manifests/#1-install-openfeature-operator-required-first","title":"1. Install OpenFeature Operator (REQUIRED FIRST!)","text":"<p>\u26a0\ufe0f IMPORTANT: Must be installed before application deployment.</p> <pre><code>helm repo add openfeature https://open-feature.github.io/open-feature-operator\nhelm install open-feature-operator openfeature/open-feature-operator \\\n  --namespace open-feature-system \\\n  --create-namespace\n</code></pre>"},{"location":"deployment/manifests/#2-create-namespace","title":"2. Create Namespace","text":"<pre><code>kubectl create namespace vegas-casino\n</code></pre>"},{"location":"deployment/manifests/#3-deploy-resources","title":"3. Deploy Resources","text":"<p>Deploy in this order:</p> <pre><code># 1. ConfigMaps and Secrets\nkubectl apply -f helm/vegas-casino/templates/configmap.yaml\nkubectl apply -f helm/vegas-casino/templates/secret.yaml\n\n# 2. Feature Flags (requires OpenFeature Operator)\nkubectl apply -f helm/vegas-casino/templates/featureflag.yaml\nkubectl apply -f helm/vegas-casino/templates/featureflagsource.yaml\n\n# 3. Database (if enabled)\nkubectl apply -f helm/vegas-casino/templates/postgresql-deployment.yaml\nkubectl apply -f helm/vegas-casino/templates/postgresql-service.yaml\n\n# 4. Redis (if enabled)\nkubectl apply -f helm/vegas-casino/templates/redis-deployment.yaml\nkubectl apply -f helm/vegas-casino/templates/redis-service.yaml\n\n# 5. Application Services\nkubectl apply -f helm/vegas-casino/templates/frontend-deployment.yaml\nkubectl apply -f helm/vegas-casino/templates/frontend-service.yaml\nkubectl apply -f helm/vegas-casino/templates/slots-deployment.yaml\nkubectl apply -f helm/vegas-casino/templates/slots-service.yaml\n# ... repeat for other services\n\n# 6. Gateway API\nkubectl apply -f helm/vegas-casino/templates/gateway.yaml\nkubectl apply -f helm/vegas-casino/templates/httproute.yaml\n</code></pre>"},{"location":"deployment/manifests/#using-helm-template","title":"Using Helm Template","text":"<p>Instead of manually applying, you can use Helm to generate manifests:</p> <pre><code># Generate all manifests\nhelm template vegas-casino ./helm/vegas-casino &gt; manifests.yaml\n\n# Apply generated manifests\nkubectl apply -f manifests.yaml\n</code></pre>"},{"location":"deployment/manifests/#customizing-manifests","title":"Customizing Manifests","text":""},{"location":"deployment/manifests/#edit-generated-manifests","title":"Edit Generated Manifests","text":"<pre><code># Generate manifests\nhelm template vegas-casino ./helm/vegas-casino &gt; manifests.yaml\n\n# Edit manifests.yaml\nvim manifests.yaml\n\n# Apply\nkubectl apply -f manifests.yaml\n</code></pre>"},{"location":"deployment/manifests/#manual-manifest-creation","title":"Manual Manifest Creation","text":"<p>Create custom manifests based on templates:</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vegas-casino-frontend\n  namespace: vegas-casino\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: frontend\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: frontend\n        image: hrexed/vegasapp-frontend:0.10\n        ports:\n        - containerPort: 3000\n        env:\n        - name: CASINO_URL\n          value: \"http://vegas-casino-frontend:3000\"\n</code></pre>"},{"location":"deployment/manifests/#verification","title":"Verification","text":"<pre><code># Check all resources\nkubectl get all -n vegas-casino\n\n# Check deployments\nkubectl get deployments -n vegas-casino\n\n# Check services\nkubectl get services -n vegas-casino\n\n# Check pods\nkubectl get pods -n vegas-casino\n\n# Check logs\nkubectl logs -n vegas-casino deployment/vegas-casino-frontend\n</code></pre>"},{"location":"deployment/manifests/#updating-manifests","title":"Updating Manifests","text":""},{"location":"deployment/manifests/#update-image","title":"Update Image","text":"<pre><code># Set new image\nkubectl set image deployment/vegas-casino-frontend \\\n  frontend=hrexed/vegasapp-frontend:0.11 \\\n  -n vegas-casino\n\n# Or edit deployment\nkubectl edit deployment vegas-casino-frontend -n vegas-casino\n</code></pre>"},{"location":"deployment/manifests/#scale-services","title":"Scale Services","text":"<pre><code># Scale frontend\nkubectl scale deployment vegas-casino-frontend --replicas=3 -n vegas-casino\n</code></pre>"},{"location":"deployment/manifests/#update-environment-variables","title":"Update Environment Variables","text":"<pre><code># Set env var\nkubectl set env deployment/vegas-casino-frontend \\\n  OTEL_EXPORTER_OTLP_ENDPOINT=otel-collector:4317 \\\n  -n vegas-casino\n</code></pre>"},{"location":"deployment/manifests/#cleanup","title":"Cleanup","text":"<pre><code># Delete all resources\nkubectl delete namespace vegas-casino\n\n# Or delete individual resources\nkubectl delete deployment vegas-casino-frontend -n vegas-casino\nkubectl delete service vegas-casino-frontend -n vegas-casino\n</code></pre>"},{"location":"deployment/manifests/#advantages-of-manifests","title":"Advantages of Manifests","text":"<ul> <li>\u2705 Full control over resources</li> <li>\u2705 No Helm dependency</li> <li>\u2705 Easy to version control</li> <li>\u2705 Direct kubectl operations</li> </ul>"},{"location":"deployment/manifests/#disadvantages","title":"Disadvantages","text":"<ul> <li>\u274c Manual configuration management</li> <li>\u274c No templating</li> <li>\u274c Harder to maintain</li> <li>\u274c No rollback support</li> </ul> <p>Next: Learn about OpenFeature Operator or return to Deployment Overview.</p>"},{"location":"deployment/openfeature/","title":"OpenFeature Operator","text":""},{"location":"deployment/openfeature/#critical-install-before-application","title":"\u26a0\ufe0f CRITICAL: Install Before Application","text":"<p>The OpenFeature Operator must be installed BEFORE deploying the Vegas Casino application. The operator manages the flagd sidecar injection and FeatureFlag CRDs.</p>"},{"location":"deployment/openfeature/#why-openfeature-operator","title":"Why OpenFeature Operator?","text":"<p>The OpenFeature Operator provides:</p> <ul> <li>\u2705 Automatic flagd sidecar injection - No manual configuration needed</li> <li>\u2705 Kubernetes-native feature flags - CRDs for flag management</li> <li>\u2705 Centralized configuration - Manage flags via Kubernetes resources</li> <li>\u2705 Dynamic updates - Change flags without redeploying services</li> </ul>"},{"location":"deployment/openfeature/#installation","title":"Installation","text":""},{"location":"deployment/openfeature/#step-1-add-helm-repository","title":"Step 1: Add Helm Repository","text":"<pre><code>helm repo add openfeature https://open-feature.github.io/open-feature-operator\nhelm repo update\n</code></pre>"},{"location":"deployment/openfeature/#step-2-install-operator","title":"Step 2: Install Operator","text":"<pre><code>helm install open-feature-operator openfeature/open-feature-operator \\\n  --namespace open-feature-system \\\n  --create-namespace \\\n  --wait\n</code></pre>"},{"location":"deployment/openfeature/#step-3-verify-installation","title":"Step 3: Verify Installation","text":"<pre><code># Check operator pod\nkubectl get pods -n open-feature-system\n\n# Verify CRDs are installed\nkubectl get crd | grep openfeature\n\n# Should see:\n# - featureflags.core.openfeature.dev\n# - featureflagsources.core.openfeature.dev\n</code></pre>"},{"location":"deployment/openfeature/#operator-components","title":"Operator Components","text":""},{"location":"deployment/openfeature/#featureflag-crd","title":"FeatureFlag CRD","text":"<p>Defines feature flag configurations:</p> <pre><code>apiVersion: core.openfeature.dev/v1beta1\nkind: FeatureFlag\nmetadata:\n  name: vegas-casino-flags\nspec:\n  flagSpec:\n    flags:\n      \"slots.progressive-jackpot\":\n        state: ENABLED\n        defaultVariant: \"true\"\n        variants:\n          \"true\": true\n          \"false\": false\n</code></pre>"},{"location":"deployment/openfeature/#featureflagsource-crd","title":"FeatureFlagSource CRD","text":"<p>Links flagd sidecar to flag definitions:</p> <pre><code>apiVersion: core.openfeature.dev/v1beta1\nkind: FeatureFlagSource\nmetadata:\n  name: vegas-casino-flag-source\nspec:\n  sources:\n    - source: vegas-casino/vegas-casino-flags\n      provider: kubernetes\n  port: 8014\n  managementPort: 8015\n</code></pre>"},{"location":"deployment/openfeature/#how-it-works","title":"How It Works","text":"<pre><code>sequenceDiagram\n    participant Admin\n    participant K8s as Kubernetes API\n    participant Operator as OpenFeature Operator\n    participant Pod as Application Pod\n    participant Flagd as flagd Sidecar\n    participant Service as Application Service\n    participant CRD as FeatureFlag CRD\n\n    Admin-&gt;&gt;K8s: Create FeatureFlag CRD\n    K8s-&gt;&gt;CRD: Store Flag Definitions\n\n    Admin-&gt;&gt;K8s: Deploy Pod with OpenFeature Annotations\n    K8s-&gt;&gt;Operator: Pod Created Event\n    Operator-&gt;&gt;Operator: Detect OpenFeature Annotations\n    Operator-&gt;&gt;Pod: Inject flagd Sidecar\n    Operator-&gt;&gt;Flagd: Configure to use FeatureFlag CRD\n    Flagd-&gt;&gt;CRD: Watch for Flag Changes\n\n    Service-&gt;&gt;Flagd: Evaluate Flag (localhost:8014)\n    Flagd-&gt;&gt;CRD: Read Flag Value\n    CRD--&gt;&gt;Flagd: Return Flag Value\n    Flagd--&gt;&gt;Service: Return Evaluation Result\n\n    Admin-&gt;&gt;CRD: Update Flag Value\n    CRD-&gt;&gt;Flagd: Notify Change\n    Flagd-&gt;&gt;Flagd: Reload Configuration</code></pre> <ol> <li>Operator watches for pods with OpenFeature annotations</li> <li>Injects flagd sidecar automatically</li> <li>Configures flagd to connect to FeatureFlag resources</li> <li>Services connect to flagd via <code>localhost:8014</code></li> </ol>"},{"location":"deployment/openfeature/#pod-annotations","title":"Pod Annotations","text":"<p>Services need these annotations for sidecar injection:</p> <pre><code>annotations:\n  openfeature.dev/enabled: \"true\"\n  openfeature.dev/featureflagsource: \"vegas-casino/vegas-casino-flag-source\"\n</code></pre>"},{"location":"deployment/openfeature/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/openfeature/#operator-not-running","title":"Operator Not Running","text":"<pre><code># Check operator status\nkubectl get pods -n open-feature-system\n\n# Check operator logs\nkubectl logs -n open-feature-system \\\n  -l control-plane=controller-manager\n</code></pre>"},{"location":"deployment/openfeature/#sidecar-not-injected","title":"Sidecar Not Injected","text":"<pre><code># Check pod annotations\nkubectl describe pod &lt;pod-name&gt; -n vegas-casino\n\n# Verify FeatureFlagSource exists\nkubectl get featureflagsource -n vegas-casino\n\n# Check flagd sidecar\nkubectl get pod &lt;pod-name&gt; -n vegas-casino -o jsonpath='{.spec.containers[*].name}'\n# Should include 'flagd'\n</code></pre>"},{"location":"deployment/openfeature/#flags-not-loading","title":"Flags Not Loading","text":"<pre><code># Check FeatureFlag resource\nkubectl get featureflag -n vegas-casino\nkubectl describe featureflag vegas-casino-flags -n vegas-casino\n\n# Check flagd logs\nkubectl logs &lt;pod-name&gt; -c flagd -n vegas-casino\n</code></pre>"},{"location":"deployment/openfeature/#port-conflicts","title":"Port Conflicts","text":"<p>If you see port conflicts:</p> <pre><code># In FeatureFlagSource, ensure ports are different\nspec:\n  port: 8014        # gRPC port\n  managementPort: 8015  # Management port (must be different)\n</code></pre>"},{"location":"deployment/openfeature/#updating-flags","title":"Updating Flags","text":""},{"location":"deployment/openfeature/#update-featureflag","title":"Update FeatureFlag","text":"<pre><code># Edit FeatureFlag\nkubectl edit featureflag vegas-casino-flags -n vegas-casino\n\n# Or apply new version\nkubectl apply -f helm/vegas-casino/templates/featureflag.yaml\n</code></pre>"},{"location":"deployment/openfeature/#verify-flag-updates","title":"Verify Flag Updates","text":"<pre><code># Check flagd logs for reload\nkubectl logs &lt;pod-name&gt; -c flagd -n vegas-casino | grep \"flag updated\"\n</code></pre>"},{"location":"deployment/openfeature/#uninstalling","title":"Uninstalling","text":"<p>\u26a0\ufe0f WARNING: Uninstalling the operator will break feature flags!</p> <pre><code># Uninstall operator\nhelm uninstall open-feature-operator -n open-feature-system\n\n# Note: This will NOT remove CRDs\n# To remove CRDs:\nkubectl delete crd featureflags.core.openfeature.dev\nkubectl delete crd featureflagsources.core.openfeature.dev\n</code></pre>"},{"location":"deployment/openfeature/#best-practices","title":"Best Practices","text":"<ol> <li>Install First: Always install operator before application</li> <li>Namespace: Use dedicated namespace for operator</li> <li>Version Pinning: Pin operator version for stability</li> <li>Resource Limits: Set appropriate limits for operator</li> <li>Monitoring: Monitor operator health and flagd sidecars</li> </ol>"},{"location":"deployment/openfeature/#additional-resources","title":"Additional Resources","text":"<ul> <li>OpenFeature Operator Documentation</li> <li>flagd Documentation</li> <li>Feature Flag Best Practices</li> </ul> <p>Next: Return to Deployment Overview or Helm Deployment.</p>"},{"location":"development/building/","title":"Building the Project","text":""},{"location":"development/building/#prerequisites","title":"Prerequisites","text":"<p>Before building the project, ensure you have:</p> <ul> <li>Docker or Podman installed</li> <li>Make installed</li> <li>Access to container registry (optional, for pushing images)</li> </ul>"},{"location":"development/building/#build-configuration","title":"Build Configuration","text":"<p>The project uses a <code>Makefile</code> for build automation. Key configuration variables:</p> <pre><code>REGISTRY ?= hrexed/vegasapp\nIMAGE_TAG ?= 0.39\nBUILDER ?= podman  # or docker\nPLATFORM ?= linux/amd64\n</code></pre>"},{"location":"development/building/#building-individual-services","title":"Building Individual Services","text":""},{"location":"development/building/#build-frontend-service","title":"Build Frontend Service","text":"<pre><code>make docker-build-frontend\n</code></pre>"},{"location":"development/building/#build-game-services","title":"Build Game Services","text":"<pre><code>make docker-build-slots\nmake docker-build-roulette\nmake docker-build-dice\nmake docker-build-blackjack\n</code></pre>"},{"location":"development/building/#build-supporting-services","title":"Build Supporting Services","text":"<pre><code>make docker-build-scoring    # Java/Spring Boot\nmake docker-build-dashboard  # Node.js\nmake docker-build-playwright # Automation\nmake docker-build-k6         # Load testing\n</code></pre>"},{"location":"development/building/#building-all-services","title":"Building All Services","text":"<p>To build all Docker images at once:</p> <pre><code>make docker-build-all\n</code></pre> <p>This will build images for: - Frontend - Slots - Roulette - Dice - Blackjack - Scoring - Dashboard - Playwright - k6</p>"},{"location":"development/building/#image-naming-convention","title":"Image Naming Convention","text":"<p>Images follow the pattern: <pre><code>{REGISTRY}-{service}:{IMAGE_TAG}\n</code></pre></p> <p>Example: - <code>hrexed/vegasapp-frontend:0.39</code> - <code>hrexed/vegasapp-slots:0.39</code> - <code>hrexed/vegasapp-scoring:0.39</code></p>"},{"location":"development/building/#pushing-images","title":"Pushing Images","text":""},{"location":"development/building/#push-individual-image","title":"Push Individual Image","text":"<pre><code>make docker-push-frontend\nmake docker-push-slots\n# ... etc\n</code></pre>"},{"location":"development/building/#push-all-images","title":"Push All Images","text":"<pre><code>make docker-push-all\n</code></pre>"},{"location":"development/building/#build-process-details","title":"Build Process Details","text":""},{"location":"development/building/#nodejs-services","title":"Node.js Services","text":"<ol> <li>Copy <code>package.json</code> and install dependencies</li> <li>Copy source code</li> <li>Set up OpenTelemetry and common modules</li> <li>Build final image</li> </ol>"},{"location":"development/building/#python-services","title":"Python Services","text":"<ol> <li>Copy <code>requirements.txt</code> and install dependencies</li> <li>Copy source code</li> <li>Set up OpenTelemetry</li> <li>Build final image</li> </ol>"},{"location":"development/building/#go-services","title":"Go Services","text":"<ol> <li>Copy <code>go.mod</code> and <code>go.sum</code></li> <li>Run <code>go mod tidy</code></li> <li>Copy source files</li> <li>Build binary</li> <li>Create minimal runtime image</li> </ol>"},{"location":"development/building/#java-services","title":"Java Services","text":"<ol> <li>Copy <code>pom.xml</code></li> <li>Run Maven build (<code>mvn clean package</code>)</li> <li>Copy JAR file</li> <li>Create runtime image with JRE</li> </ol>"},{"location":"development/building/#troubleshooting","title":"Troubleshooting","text":""},{"location":"development/building/#build-failures","title":"Build Failures","text":"<p>Issue: Node.js dependencies fail to install <pre><code># Solution: Clear npm cache and rebuild\ndocker system prune -a\nmake docker-build-frontend\n</code></pre></p> <p>Issue: Go build fails <pre><code># Solution: Ensure Go modules are up to date\ncd services/dice/go\ngo mod tidy\n</code></pre></p> <p>Issue: Maven build fails <pre><code># Solution: Clear Maven cache\ncd services/scoring\nmvn clean\nmake docker-build-scoring\n</code></pre></p>"},{"location":"development/building/#platform-specific-issues","title":"Platform-Specific Issues","text":"<p>For ARM64 (Apple Silicon): <pre><code>make docker-build-all PLATFORM=linux/arm64\n</code></pre></p> <p>For multi-platform builds: <pre><code>docker buildx build --platform linux/amd64,linux/arm64 -t image:tag .\n</code></pre></p>"},{"location":"development/building/#build-verification","title":"Build Verification","text":"<p>After building, verify images:</p> <pre><code># List all images\ndocker images | grep vegasapp\n\n# Test an image\ndocker run --rm hrexed/vegasapp-frontend:0.10 node --version\n</code></pre>"},{"location":"development/building/#next-steps","title":"Next Steps","text":"<p>After building images: 1. Push to registry 2. Deploy with Helm 3. Run tests</p> <p>Next: Learn about Docker Images or Deployment.</p>"},{"location":"development/docker/","title":"Docker Images","text":""},{"location":"development/docker/#image-overview","title":"Image Overview","text":"<p>The Vegas Casino project consists of multiple Docker images, each serving a specific purpose in the microservices architecture.</p>"},{"location":"development/docker/#available-images","title":"Available Images","text":""},{"location":"development/docker/#application-images","title":"Application Images","text":"Service Base Image Ports Purpose <code>frontend</code> <code>node:18-alpine</code> 3000 Web UI and API gateway <code>slots</code> <code>node:18-alpine</code> 8081, 50051 Slots game service <code>roulette</code> <code>python:3.11-slim</code> 8082, 50052 Roulette game service <code>dice</code> <code>golang:1.21-alpine</code> 8083, 50053 Dice game service <code>blackjack</code> <code>node:18-alpine</code> 8084, 50054 Blackjack game service <code>scoring</code> <code>eclipse-temurin:17-jre-alpine</code> 8085 Scoring and leaderboard service <code>dashboard</code> <code>node:18-alpine</code> 3001 Analytics dashboard"},{"location":"development/docker/#testing-images","title":"Testing Images","text":"Service Base Image Purpose <code>playwright</code> <code>mcr.microsoft.com/playwright:v1.40.0-focal</code> Browser automation <code>k6</code> <code>grafana/k6:latest</code> Load testing"},{"location":"development/docker/#image-structure","title":"Image Structure","text":""},{"location":"development/docker/#nodejs-services","title":"Node.js Services","text":"<pre><code>FROM node:18-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm install\nCOPY services/{service}/ ./\nCOPY services/common/ ./common/\nCMD [\"node\", \"service-file.js\"]\n</code></pre>"},{"location":"development/docker/#python-services","title":"Python Services","text":"<pre><code>FROM python:3.11-slim\nWORKDIR /app\nCOPY requirements.txt ./\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY services/{service}/ ./\nCMD [\"python\", \"service-file.py\"]\n</code></pre>"},{"location":"development/docker/#go-services","title":"Go Services","text":"<pre><code>FROM golang:1.21-alpine AS builder\nWORKDIR /app\nCOPY go.mod go.sum ./\nRUN go mod download\nCOPY . .\nRUN go build -o service-binary\n\nFROM alpine:latest\nCOPY --from=builder /app/service-binary /service-binary\nCMD [\"/service-binary\"]\n</code></pre>"},{"location":"development/docker/#java-services","title":"Java Services","text":"<pre><code>FROM maven:3.9-eclipse-temurin-17 AS builder\nWORKDIR /app\nCOPY pom.xml ./\nRUN mvn dependency:go-offline\nCOPY src ./src\nRUN mvn clean package -DskipTests\n\nFROM eclipse-temurin:17-jre-alpine\nCOPY --from=builder /app/target/*.jar app.jar\nCMD [\"java\", \"-jar\", \"app.jar\"]\n</code></pre>"},{"location":"development/docker/#environment-variables","title":"Environment Variables","text":"<p>All images support environment variables for configuration:</p>"},{"location":"development/docker/#common-variables","title":"Common Variables","text":"<ul> <li><code>PORT</code>: Service HTTP port</li> <li><code>OTEL_EXPORTER_OTLP_ENDPOINT</code>: OpenTelemetry collector endpoint</li> <li><code>OTEL_EXPORTER_OTLP_PROTOCOL</code>: Protocol (grpc/http)</li> </ul>"},{"location":"development/docker/#service-specific-variables","title":"Service-Specific Variables","text":"<ul> <li><code>REDIS_HOST</code>, <code>REDIS_PORT</code>: Redis connection</li> <li><code>SCORING_SERVICE_URL</code>: Scoring service endpoint</li> <li><code>FLAGD_HOST</code>, <code>FLAGD_PORT</code>: Feature flag service (if not using operator)</li> </ul>"},{"location":"development/docker/#image-tags","title":"Image Tags","text":"<p>Images are tagged with: - Version Tag: From <code>IMAGE_TAG</code> (default: <code>0.10</code>) - Latest Tag: <code>latest</code> (optional)</p> <p>Example: <pre><code>hrexed/vegasapp-frontend:0.10\nhrexed/vegasapp-frontend:latest\n</code></pre></p>"},{"location":"development/docker/#building-images","title":"Building Images","text":"<p>See Building the Project for detailed build instructions.</p>"},{"location":"development/docker/#pushing-images","title":"Pushing Images","text":""},{"location":"development/docker/#to-docker-hub","title":"To Docker Hub","text":"<pre><code># Login first\ndocker login\n\n# Push images\nmake docker-push-all\n</code></pre>"},{"location":"development/docker/#to-private-registry","title":"To Private Registry","text":"<pre><code># Set registry\nexport REGISTRY=your-registry.com/vegasapp\nmake docker-build-all\nmake docker-push-all\n</code></pre>"},{"location":"development/docker/#image-sizes","title":"Image Sizes","text":"<p>Approximate image sizes:</p> Image Size <code>frontend</code> ~150MB <code>slots</code> ~150MB <code>roulette</code> ~200MB <code>dice</code> ~20MB <code>blackjack</code> ~150MB <code>scoring</code> ~200MB <code>dashboard</code> ~150MB <code>playwright</code> ~1.5GB <code>k6</code> ~50MB"},{"location":"development/docker/#multi-stage-builds","title":"Multi-Stage Builds","text":"<p>Several services use multi-stage builds to reduce final image size:</p> <ul> <li>Go Services: Build binary in builder stage, copy to minimal runtime</li> <li>Java Services: Build JAR in Maven stage, copy to JRE-only runtime</li> </ul>"},{"location":"development/docker/#image-security","title":"Image Security","text":"<ul> <li>Base Images: Use official, regularly updated base images</li> <li>Non-Root Users: Services run as non-root when possible</li> <li>Minimal Images: Alpine-based images for smaller attack surface</li> <li>Dependency Scanning: Regularly update dependencies</li> </ul> <p>Next: Learn about Testing or Deployment.</p>"},{"location":"overview/","title":"Project Overview","text":""},{"location":"overview/#what-is-vegas-casino","title":"What is Vegas Casino?","text":"<p>Vegas Casino is a microservices-based casino application designed specifically for observability hackathons. The project provides a realistic, production-like environment where attendees can practice and improve:</p> <ul> <li>Distributed Tracing: End-to-end trace correlation across services</li> <li>Feature Flag Management: OpenFeature integration with flagd</li> <li>Observability Pipelines: OpenTelemetry instrumentation and export</li> <li>Performance Testing: Load testing with k6 and automation with Playwright</li> <li>DevOps Practices: Containerization, Kubernetes deployment, and CI/CD</li> </ul>"},{"location":"overview/#project-goals","title":"Project Goals","text":"<p>The primary goal of this project is to provide a hands-on learning environment for observability practitioners. Attendees will:</p> <ol> <li>Improve Instrumentation: Add and enhance OpenTelemetry spans across services</li> <li>Optimize Pipelines: Configure and tune observability data pipelines</li> <li>Implement Feature Flags: Integrate and manage feature flags using OpenFeature</li> <li>Enhance Testing: Create and run load tests and automation scripts</li> <li>Practice Deployment: Deploy and manage the application in Kubernetes</li> </ol>"},{"location":"overview/#application-structure","title":"Application Structure","text":"<p>The Vegas Casino consists of:</p> <ul> <li>4 Game Services: Slots, Roulette, Dice, and Blackjack</li> <li>Frontend Service: Web UI for players</li> <li>Scoring Service: Leaderboards and game statistics</li> <li>Dashboard Service: Analytics and reporting</li> <li>Supporting Services: Redis, PostgreSQL, OpenTelemetry Collector</li> </ul>"},{"location":"overview/#why-this-project","title":"Why This Project?","text":"<p>This project is designed to simulate real-world challenges:</p> <ul> <li>\u2705 Multiple programming languages (Node.js, Python, Go, Java)</li> <li>\u2705 Different communication patterns (HTTP, gRPC)</li> <li>\u2705 Complex data flows (frontend \u2192 games \u2192 scoring \u2192 database)</li> <li>\u2705 Feature flag integration across services</li> <li>\u2705 Distributed tracing requirements</li> <li>\u2705 Performance and load testing scenarios</li> </ul> <p>Next: Learn about the Hackathon Context or explore the Architecture.</p>"},{"location":"overview/hackathon/","title":"Hackathon Context","text":""},{"location":"overview/hackathon/#purpose","title":"Purpose","text":"<p>The Vegas Casino project is designed for observability hackathons where participants work together to improve instrumentation, observability pipelines, and application monitoring.</p>"},{"location":"overview/hackathon/#hackathon-objectives","title":"Hackathon Objectives","text":"<p>During the hackathon, attendees will:</p>"},{"location":"overview/hackathon/#1-instrumentation-challenges","title":"1. Instrumentation Challenges","text":"<ul> <li>Add Missing Spans: Identify and add OpenTelemetry spans for business logic</li> <li>Improve Trace Correlation: Ensure end-to-end trace propagation across services</li> <li>Enhance Attributes: Add meaningful attributes to spans for better observability</li> <li>Database Instrumentation: Add spans for PostgreSQL and Redis operations</li> </ul>"},{"location":"overview/hackathon/#2-feature-flag-integration","title":"2. Feature Flag Integration","text":"<ul> <li>Implement Feature Flags: Add feature flag evaluation in game services</li> <li>Configure flagd: Set up and configure flagd sidecar injection</li> <li>Test Flag Variations: Experiment with different flag states and targeting</li> </ul>"},{"location":"overview/hackathon/#3-observability-pipeline","title":"3. Observability Pipeline","text":"<ul> <li>Configure Exporters: Set up OpenTelemetry exporters (HTTP/gRPC)</li> <li>Optimize Data Flow: Tune collector configuration for performance</li> <li>Add Custom Metrics: Create custom metrics for business KPIs</li> </ul>"},{"location":"overview/hackathon/#4-testing-and-validation","title":"4. Testing and Validation","text":"<ul> <li>Create Load Tests: Write k6 scripts for different scenarios</li> <li>Automate Testing: Enhance Playwright scripts for comprehensive coverage</li> <li>Validate Traces: Ensure traces are properly connected and complete</li> </ul>"},{"location":"overview/hackathon/#5-deployment-and-operations","title":"5. Deployment and Operations","text":"<ul> <li>Helm Chart Improvements: Enhance Helm charts with better configuration</li> <li>Resource Optimization: Tune resource requests and limits</li> <li>Monitoring Setup: Configure dashboards and alerts</li> </ul>"},{"location":"overview/hackathon/#hackathon-structure","title":"Hackathon Structure","text":""},{"location":"overview/hackathon/#phase-1-exploration-30-minutes","title":"Phase 1: Exploration (30 minutes)","text":"<ul> <li>Understand the architecture</li> <li>Explore existing instrumentation</li> <li>Identify gaps and opportunities</li> </ul>"},{"location":"overview/hackathon/#phase-2-implementation-2-3-hours","title":"Phase 2: Implementation (2-3 hours)","text":"<ul> <li>Work on assigned challenges</li> <li>Implement improvements</li> <li>Test and validate changes</li> </ul>"},{"location":"overview/hackathon/#phase-3-validation-30-minutes","title":"Phase 3: Validation (30 minutes)","text":"<ul> <li>Run load tests</li> <li>Verify trace completeness</li> <li>Review observability data</li> </ul>"},{"location":"overview/hackathon/#phase-4-presentation-30-minutes","title":"Phase 4: Presentation (30 minutes)","text":"<ul> <li>Share improvements made</li> <li>Demonstrate trace flows</li> <li>Discuss learnings</li> </ul>"},{"location":"overview/hackathon/#success-criteria","title":"Success Criteria","text":"<p>A successful hackathon session should result in:</p> <ul> <li>\u2705 Complete Trace Coverage: All user actions produce connected traces</li> <li>\u2705 Feature Flag Integration: Feature flags are evaluated and traced</li> <li>\u2705 Database Instrumentation: All database operations are instrumented</li> <li>\u2705 Load Test Results: k6 tests generate realistic traffic and traces</li> <li>\u2705 End-to-End Visibility: Traces connect from frontend \u2192 games \u2192 scoring \u2192 database</li> </ul>"},{"location":"overview/hackathon/#getting-started","title":"Getting Started","text":"<ol> <li>Clone the Repository: Get the latest code</li> <li>Review Architecture: Understand the system design</li> <li>Build and Deploy: Get the application running</li> <li>Explore Traces: Check existing instrumentation</li> <li>Pick a Challenge: Choose an area to improve</li> <li>Implement and Test: Make changes and validate</li> </ol> <p>Ready to start? Check out the Architecture or Building Guide.</p>"},{"location":"snippets/api-token/","title":"Api token","text":""},{"location":"snippets/api-token/#operator-token-permissions","title":"Operator token  permissions:","text":"<ul> <li>Create ActiveGate tokens</li> <li>Read entities</li> <li>Read Settings</li> <li>Write Settings</li> <li>Access problem and event feed, metrics and topology</li> <li>Read configuration</li> <li>Write configuration</li> <li>Paas integration - installer downloader</li> </ul>"},{"location":"snippets/api-token/#ingest-token-permissions","title":"Ingest token permissions :","text":"<ul> <li>Ingest metrics (metrics.ingest)</li> <li>Ingest logs (logs.ingest)</li> <li>Ingest events (events.ingest)</li> <li>Ingest OpenTelemetry</li> <li>Read metrics</li> </ul>"},{"location":"snippets/info-required/","title":"Info required","text":"<p>The codespace will require to define several details: </p> <pre><code>* Environment ID\n* Environment Type\n* Operator API Token\n* Ingest API Token\n* Cluster Name\n* The Oauth Client ID\n* The Oauth Client Secret\n* the Oauth Client URN\n</code></pre>"},{"location":"snippets/tenant-id/","title":"Tenant id","text":""},{"location":"snippets/tenant-id/#gather-details-tenant-id-environment","title":"Gather Details: Tenant ID &amp; Environment","text":"<p>You will need access to a Dynatrace tenant. If you do not have access, sign up for a free 15 day trial.</p> <p>Make a note of your Dynatrace tenant ID. It is the first bit of your URL (eg. <code>abc12345</code> in the following examples):</p> <pre><code>https://abc12345.live.dynatrace.com\nhttps://abc12345.apps.dynatrace.com\n</code></pre>"},{"location":"snippets/tenant-id/#gather-details-environment-type","title":"Gather Details: Environment Type","text":"<p>Make a note of your \"environment type\" based on your URL.</p> <p>If you are unsure, use <code>live</code>.</p> URL Environment Type abc12345.apps.dynatrace.com live abc12345.live.dynatrace.com live abc12345.sprint.dynatracelabs.com sprint abc12345.dev.dynatracelabs.com dev"},{"location":"testing/","title":"Testing Overview","text":"<p>The Vegas Casino project includes two types of automated testing:</p> <ol> <li>Playwright - End-to-end browser automation</li> <li>k6 - Load and performance testing</li> </ol> <p>Both testing tools are containerized and can be deployed as Kubernetes Jobs or run locally.</p>"},{"location":"testing/#testing-strategy","title":"Testing Strategy","text":""},{"location":"testing/#playwright-tests","title":"Playwright Tests","text":"<ul> <li>Purpose: Simulate real user journeys</li> <li>Scope: Full application flow from entry to dashboard</li> <li>Execution: Continuous or one-time runs</li> <li>Output: Console logs and traces</li> </ul>"},{"location":"testing/#k6-load-tests","title":"k6 Load Tests","text":"<ul> <li>Purpose: Performance and scalability testing</li> <li>Scope: API endpoints under load</li> <li>Execution: Configurable duration and virtual users</li> <li>Output: Performance metrics and statistics</li> </ul>"},{"location":"testing/#test-coverage","title":"Test Coverage","text":"<pre><code>flowchart TD\n    Start([Test Start]) --&gt; Enter[Enter Casino]\n    Enter --&gt; Deposit1[Deposit Funds]\n    Deposit1 --&gt; PlaySlots[Play Slots&lt;br/&gt;+ Enable Cheats]\n    PlaySlots --&gt; Lobby1[Return to Lobby]\n    Lobby1 --&gt; Deposit2[Deposit Funds]\n    Deposit2 --&gt; PlayRoulette[Play Roulette&lt;br/&gt;+ Enable Cheats]\n    PlayRoulette --&gt; Lobby2[Return to Lobby]\n    Lobby2 --&gt; Deposit3[Deposit Funds]\n    Deposit3 --&gt; PlayDice[Play Dice]\n    PlayDice --&gt; Lobby3[Return to Lobby]\n    Lobby3 --&gt; Deposit4[Deposit Funds]\n    Deposit4 --&gt; PlayBlackjack[Play Blackjack]\n    PlayBlackjack --&gt; ViewDashboard[View Dashboard]\n    ViewDashboard --&gt; CheckStats[Check Statistics]\n    CheckStats --&gt; End([Test Complete])\n\n    style Start fill:#10b981,stroke:#059669,color:#fff\n    style End fill:#10b981,stroke:#059669,color:#fff\n    style PlaySlots fill:#f59e0b,stroke:#d97706,color:#fff\n    style PlayRoulette fill:#f59e0b,stroke:#d97706,color:#fff\n    style ViewDashboard fill:#9333ea,stroke:#7c3aed,color:#fff</code></pre> <p>Both test suites cover:</p> <ul> <li>\u2705 User registration and entry</li> <li>\u2705 Game selection and play</li> <li>\u2705 Feature flag activation</li> <li>\u2705 Deposit functionality</li> <li>\u2705 Dashboard viewing</li> </ul>"},{"location":"testing/#running-tests","title":"Running Tests","text":""},{"location":"testing/#playwright","title":"Playwright","text":"<pre><code># Via Helm (as Job)\nhelm upgrade --install vegas-casino ./helm/vegas-casino \\\n  --set playwright.enabled=true\n\n# Or manually\nkubectl apply -f helm/vegas-casino/templates/playwright-deployment.yaml\n</code></pre>"},{"location":"testing/#k6","title":"k6","text":"<pre><code># Via Helm (as Job)\nhelm upgrade --install vegas-casino ./helm/vegas-casino \\\n  --set k6.enabled=true\n\n# Or manually\nkubectl apply -f helm/vegas-casino/templates/k6-deployment.yaml\n</code></pre> <p>Next: Learn about Playwright Tests or k6 Load Tests.</p>"},{"location":"testing/k6/","title":"k6 Load Tests","text":""},{"location":"testing/k6/#overview","title":"Overview","text":"<p>k6 is a modern load testing tool that generates HTTP traffic to test application performance, scalability, and reliability under various load conditions.</p>"},{"location":"testing/k6/#what-k6-tests-do","title":"What k6 Tests Do","text":"<p>The k6 test script (<code>load-test.js</code>) simulates multiple virtual users performing:</p> <ol> <li>Enter Casino - POST <code>/api/user/init</code></li> <li>Deposit Funds - POST <code>/api/user/topup</code></li> <li>Play Games - POST <code>/api/games/{game}/{action}</code> with feature flags</li> <li>Deposit Again - POST <code>/api/user/topup</code></li> <li>Check Dashboard - GET <code>/api/dashboard/{game}</code></li> </ol>"},{"location":"testing/k6/#test-configuration","title":"Test Configuration","text":""},{"location":"testing/k6/#environment-variables","title":"Environment Variables","text":"Variable Default Description <code>CASINO_URL</code> <code>http://localhost:3000</code> Frontend service URL <code>VUS</code> <code>10</code> Virtual Users (concurrent) <code>DURATION</code> <code>5m</code> Test duration <code>RAMP_UP</code> <code>30s</code> Ramp-up time"},{"location":"testing/k6/#test-stages","title":"Test Stages","text":"<p>k6 uses a staged approach:</p> <ol> <li>Ramp-up: Gradually increase to target VUs</li> <li>Sustained Load: Maintain VUs for duration</li> <li>Ramp-down: Gradually decrease to 0</li> </ol> <p>Example: <pre><code>stages: [\n  { duration: '30s', target: 10 },  // Ramp up to 10 VUs\n  { duration: '5m', target: 10 },   // Stay at 10 VUs\n  { duration: '30s', target: 0 },   // Ramp down\n]\n</code></pre></p>"},{"location":"testing/k6/#metrics","title":"Metrics","text":""},{"location":"testing/k6/#built-in-metrics","title":"Built-in Metrics","text":"<ul> <li><code>http_req_duration</code>: Request duration</li> <li><code>http_req_failed</code>: Failed request rate</li> <li><code>http_reqs</code>: Total requests</li> <li><code>vus</code>: Virtual users</li> <li><code>iterations</code>: Completed iterations</li> </ul>"},{"location":"testing/k6/#custom-metrics","title":"Custom Metrics","text":"<ul> <li><code>errors</code>: Error rate</li> <li><code>success</code>: Success rate</li> </ul>"},{"location":"testing/k6/#thresholds","title":"Thresholds","text":"<p>Default thresholds: - 95% of requests &lt; 2 seconds - Error rate &lt; 10% - Success rate &gt; 90%</p>"},{"location":"testing/k6/#running-k6-tests","title":"Running k6 Tests","text":""},{"location":"testing/k6/#via-helm","title":"Via Helm","text":"<pre><code># Enable and configure\nhelm upgrade --install vegas-casino ./helm/vegas-casino \\\n  --set k6.enabled=true \\\n  --set k6.vus=20 \\\n  --set k6.duration=10m \\\n  --set k6.rampUp=1m\n</code></pre>"},{"location":"testing/k6/#via-kubernetes-job","title":"Via Kubernetes Job","text":"<pre><code># Create job manually\nkubectl create job k6-load-test \\\n  --image=hrexed/vegasapp-k6:0.10 \\\n  --env=\"CASINO_URL=http://vegas-casino-frontend:3000\" \\\n  --env=\"VUS=20\" \\\n  --env=\"DURATION=10m\"\n</code></pre>"},{"location":"testing/k6/#locally","title":"Locally","text":"<pre><code># Install k6\nbrew install k6  # macOS\n# or download from https://k6.io/docs/getting-started/installation/\n\n# Run test\nk6 run services/k6/load-test.js \\\n  --env CASINO_URL=http://localhost:3000 \\\n  --env VUS=10 \\\n  --env DURATION=5m\n</code></pre>"},{"location":"testing/k6/#via-docker","title":"Via Docker","text":"<pre><code># Build image\nmake docker-build-k6\n\n# Run locally\ndocker run --rm \\\n  -e CASINO_URL=http://localhost:3000 \\\n  -e VUS=20 \\\n  -e DURATION=10m \\\n  hrexed/vegasapp-k6:0.10\n</code></pre>"},{"location":"testing/k6/#test-scenarios","title":"Test Scenarios","text":""},{"location":"testing/k6/#light-load","title":"Light Load","text":"<pre><code>k6:\n  vus: \"5\"\n  duration: \"2m\"\n  rampUp: \"30s\"\n</code></pre>"},{"location":"testing/k6/#medium-load","title":"Medium Load","text":"<pre><code>k6:\n  vus: \"20\"\n  duration: \"10m\"\n  rampUp: \"1m\"\n</code></pre>"},{"location":"testing/k6/#heavy-load","title":"Heavy Load","text":"<pre><code>k6:\n  vus: \"50\"\n  duration: \"30m\"\n  rampUp: \"5m\"\n</code></pre>"},{"location":"testing/k6/#output","title":"Output","text":"<p>k6 provides detailed output:</p> <pre><code>     \u2713 entered casino successfully\n     \u2713 deposit successful\n     \u2713 balance updated\n     \u2713 slots game played\n     \u2713 game response valid\n     \u2713 dashboard loaded\n     \u2713 dashboard has data\n\n     checks.........................: 100.00% \u2713 350    \u2717 0\n     data_received..................: 2.1 MB  7.0 kB/s\n     data_sent......................: 450 kB  1.5 kB/s\n     http_req_duration..............: avg=245ms min=120ms med=230ms max=890ms p(95)=450ms\n     http_req_failed................: 0.00%   \u2713 0      \u2717 350\n     http_reqs......................: 350    1.166667/s\n     iterations.....................: 50     0.166667/s\n     vus............................: 10     min=10    max=10\n</code></pre>"},{"location":"testing/k6/#interpreting-results","title":"Interpreting Results","text":""},{"location":"testing/k6/#good-performance","title":"Good Performance","text":"<ul> <li><code>http_req_duration p(95) &lt; 2000ms</code></li> <li><code>http_req_failed &lt; 0.1</code></li> <li><code>errors &lt; 0.1</code></li> <li><code>success &gt; 0.9</code></li> </ul>"},{"location":"testing/k6/#performance-issues","title":"Performance Issues","text":"<ul> <li>High <code>http_req_duration</code> \u2192 Service overload</li> <li>High <code>http_req_failed</code> \u2192 Service errors</li> <li>Increasing <code>vus</code> \u2192 Resource constraints</li> </ul>"},{"location":"testing/k6/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"testing/k6/#custom-test-scenarios","title":"Custom Test Scenarios","text":"<p>Edit <code>load-test.js</code> to add custom scenarios:</p> <pre><code>export const options = {\n  scenarios: {\n    spike: {\n      executor: 'ramping-vus',\n      startVUs: 0,\n      stages: [\n        { duration: '10s', target: 100 },\n        { duration: '1m', target: 100 },\n        { duration: '10s', target: 0 },\n      ],\n    },\n  },\n};\n</code></pre>"},{"location":"testing/k6/#custom-metrics_1","title":"Custom Metrics","text":"<p>Add custom metrics:</p> <pre><code>import { Trend, Counter } from 'k6/metrics';\n\nconst gamePlayDuration = new Trend('game_play_duration');\nconst depositsCount = new Counter('deposits_total');\n</code></pre>"},{"location":"testing/k6/#troubleshooting","title":"Troubleshooting","text":""},{"location":"testing/k6/#high-error-rate","title":"High Error Rate","text":"<ul> <li>Check service availability</li> <li>Verify CASINO_URL is correct</li> <li>Review service logs</li> <li>Check resource limits</li> </ul>"},{"location":"testing/k6/#slow-response-times","title":"Slow Response Times","text":"<ul> <li>Increase service replicas</li> <li>Check database performance</li> <li>Review Redis connectivity</li> <li>Monitor resource usage</li> </ul>"},{"location":"testing/k6/#test-fails-to-start","title":"Test Fails to Start","text":"<ul> <li>Verify CASINO_URL is accessible</li> <li>Check k6 image is built</li> <li>Review job logs: <code>kubectl logs job/k6-load-test</code></li> </ul> <p>Next: Learn about Deployment or return to Testing Overview.</p>"},{"location":"testing/playwright/","title":"Playwright Tests","text":""},{"location":"testing/playwright/#overview","title":"Overview","text":"<p>Playwright automation simulates complete user journeys through the Vegas Casino application. It uses a headless browser to interact with the web UI, just like a real user would.</p>"},{"location":"testing/playwright/#what-playwright-tests-do","title":"What Playwright Tests Do","text":"<p>The Playwright test script (<code>simulate-user.js</code>) performs the following actions:</p> <ol> <li>Login/Profile Setup</li> <li>Navigate to frontend (redirects to login if not authenticated)</li> <li>Fill in user profile information:<ul> <li>Player Name</li> <li>Email</li> <li>Profile Type (Partner, Customer, Dynatracer, Other)</li> <li>Starting Balance (minimum $10, default $1000)</li> </ul> </li> <li> <p>Submit login form</p> </li> <li> <p>Play Each Game</p> </li> <li>Navigate to slots, roulette, dice, and blackjack</li> <li>Place bets</li> <li>Enable feature flags (cheats)</li> <li> <p>Interact with game controls</p> </li> <li> <p>Deposit Funds</p> </li> <li>Click deposit button between games</li> <li> <p>Verify balance updates</p> </li> <li> <p>View Dashboard</p> </li> <li>Navigate to dashboard</li> <li>View stats for each game</li> <li>Verify data display</li> </ol>"},{"location":"testing/playwright/#configuration","title":"Configuration","text":""},{"location":"testing/playwright/#environment-variables","title":"Environment Variables","text":"Variable Default Description <code>CASINO_URL</code> <code>http://localhost:3000</code> Frontend service URL <code>USER_NAME</code> <code>PlaywrightUser_{timestamp}</code> Test user name <code>USER_EMAIL</code> <code>playwright@example.com</code> Test user email <code>PROFILE_TYPE</code> <code>Customer</code> Profile type (Partner, Customer, Dynatracer, Other) <code>STARTING_BALANCE</code> <code>1000</code> Initial balance (minimum $10) <code>DELAY_BETWEEN_ACTIONS</code> <code>2000</code> Milliseconds between actions <code>DELAY_BETWEEN_GAMES</code> <code>5000</code> Milliseconds between games <code>RUN_CONTINUOUSLY</code> <code>false</code> Run in continuous loop <code>ITERATIONS</code> <code>1</code> Number of iterations"},{"location":"testing/playwright/#helm-configuration","title":"Helm Configuration","text":"<pre><code>playwright:\n  enabled: true\n  casinoUrl: \"\"  # Auto-detect if empty\n  userName: \"PlaywrightUser\"\n  userEmail: \"playwright@example.com\"\n  profileType: \"Customer\"  # Options: Partner, Customer, Dynatracer, Other\n  startingBalance: \"1000\"  # Minimum: 10\n  delayBetweenActions: \"2000\"\n  delayBetweenGames: \"5000\"\n  runContinuously: \"false\"\n  iterations: \"1\"\n</code></pre>"},{"location":"testing/playwright/#running-playwright-tests","title":"Running Playwright Tests","text":""},{"location":"testing/playwright/#via-helm","title":"Via Helm","text":"<pre><code># Enable and deploy\nhelm upgrade --install vegas-casino ./helm/vegas-casino \\\n  --set playwright.enabled=true \\\n  --set playwright.runContinuously=false \\\n  --set playwright.iterations=5\n</code></pre>"},{"location":"testing/playwright/#via-kubernetes-job","title":"Via Kubernetes Job","text":"<pre><code># Create job manually\nkubectl create job playwright-test \\\n  --from=job/vegas-casino-playwright-1 \\\n  --dry-run=client -o yaml | kubectl apply -f -\n</code></pre>"},{"location":"testing/playwright/#locally","title":"Locally","text":"<pre><code># Build image\nmake docker-build-playwright\n\n# Run locally\ndocker run --rm \\\n  -e CASINO_URL=http://localhost:3000 \\\n  -e USER_NAME=TestUser \\\n  -e ITERATIONS=1 \\\n  hrexed/vegasapp-playwright:0.10\n</code></pre>"},{"location":"testing/playwright/#test-flow","title":"Test Flow","text":"<pre><code>1. Login/Profile Setup\n   \u2193\n2. Navigate to Lobby\n   \u2193\n3. Deposit Funds (if needed)\n   \u2193\n3. Play Slots (with cheats enabled)\n   \u2193\n4. Return to Lobby\n   \u2193\n5. Deposit Funds\n   \u2193\n6. Play Roulette (with cheats enabled)\n   \u2193\n7. Return to Lobby\n   \u2193\n8. Deposit Funds\n   \u2193\n9. Play Dice\n   \u2193\n10. Return to Lobby\n    \u2193\n11. Deposit Funds\n    \u2193\n12. Play Blackjack\n    \u2193\n13. View Dashboard (all games)\n    \u2193\n14. View Dashboard (per game)\n</code></pre>"},{"location":"testing/playwright/#output","title":"Output","text":"<p>Playwright tests output: - Console logs for each action - Success/failure indicators - Error messages if actions fail - Trace information (if configured)</p> <p>Example output: <pre><code>\ud83c\udfb0 [PlaywrightUser] Entering casino...\n\u2705 [PlaywrightUser] Successfully entered casino\n\ud83d\udcb0 [PlaywrightUser] Depositing funds...\n\u2705 [PlaywrightUser] Deposited funds\n\ud83c\udfb0 [PlaywrightUser] Playing slots...\n\ud83d\udd27 [PlaywrightUser] Enabled cheats for slots\n\u2705 [PlaywrightUser] Finished playing slots\n</code></pre></p>"},{"location":"testing/playwright/#continuous-testing","title":"Continuous Testing","text":"<p>To run Playwright continuously:</p> <pre><code>playwright:\n  runContinuously: \"true\"\n</code></pre> <p>This will run the test in an infinite loop, generating continuous traffic.</p>"},{"location":"testing/playwright/#troubleshooting","title":"Troubleshooting","text":""},{"location":"testing/playwright/#browser-launch-fails","title":"Browser Launch Fails","text":"<ul> <li>Ensure pod has proper security context (SYS_ADMIN capability)</li> <li>Check resource limits (Playwright needs memory)</li> </ul>"},{"location":"testing/playwright/#page-load-timeouts","title":"Page Load Timeouts","text":"<ul> <li>Increase <code>DELAY_BETWEEN_ACTIONS</code></li> <li>Check frontend service availability</li> <li>Verify CASINO_URL is correct</li> </ul>"},{"location":"testing/playwright/#element-not-found","title":"Element Not Found","text":"<ul> <li>Check if UI has changed</li> <li>Verify selectors in <code>simulate-user.js</code></li> <li>Check browser console logs</li> </ul> <p>Next: Learn about k6 Load Tests or Deployment.</p>"}]}